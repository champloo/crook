{"id":"crook-09q","title":"Kubernetes Client Wrapper","description":"Implement client-go wrapper for node, deployment, pod, and Ceph operations with retry logic","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-03T15:51:53.559564404+11:00","created_by":"andri","updated_at":"2026-01-03T19:30:30.045655633+11:00","closed_at":"2026-01-03T19:30:30.045655633+11:00","close_reason":"Closed"}
{"id":"crook-0c6","title":"Implement deployment discovery logic","description":"Create pkg/maintenance/discovery.go to find target deployments on node.\n\nAcceptance Criteria:\n- DiscoverDeployments(ctx, k8sClient, nodeName, prefixes) returns deployment list\n- Query pods on node with field selector\n- Traverse Pod → ReplicaSet → Deployment ownership chain\n- Filter by configured prefixes (rook-ceph-osd, rook-ceph-mon, etc.)\n- Return unique deployments (no duplicates)\n- Handle pods without owners gracefully\n\nContext:\nImplements specs/node-maintenance/spec.md 'Deployment Discovery' requirement. Critical for down phase.\n\nDependencies:\n- Requires pkg/k8s pods and ownership traversal (crook-86k)\n\nDeliverables:\n- pkg/maintenance/discovery.go\n- Unit tests with mock K8s client\n- Integration test (optional)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:56:24.663537023+11:00","created_by":"andri","updated_at":"2026-01-04T01:26:47.901193774+11:00","closed_at":"2026-01-04T01:26:47.901196439+11:00","dependencies":[{"issue_id":"crook-0c6","depends_on_id":"crook-42s","type":"parent-child","created_at":"2026-01-03T15:56:38.75106376+11:00","created_by":"andri"},{"issue_id":"crook-0c6","depends_on_id":"crook-86k","type":"blocks","created_at":"2026-01-03T18:09:14.777278346+11:00","created_by":"andri"}]}
{"id":"crook-0ef","title":"Add version command and shell completion","description":"Add version command and generate shell completion scripts.\n\nAcceptance Criteria:\n- 'crook version' shows version, commit, build date\n- Shell completion generation for bash, zsh, fish\n- 'crook completion bash|zsh|fish' generates completion script\n- Version info injected at build time via ldflags\n\nContext:\nPer tasks.md 8.6-8.7.\n\nDeliverables:\n- cmd/crook/version.go\n- cmd/crook/completion.go\n- Build script with version injection","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:59:03.729956801+11:00","created_by":"andri","updated_at":"2026-01-04T14:22:51.510726598+11:00","closed_at":"2026-01-04T14:22:51.510726598+11:00","close_reason":"Added shell completion command (bash/zsh/fish/powershell) and justfile with version injection via ldflags","dependencies":[{"issue_id":"crook-0ef","depends_on_id":"crook-3yn","type":"parent-child","created_at":"2026-01-03T15:59:12.302295767+11:00","created_by":"andri"}]}
{"id":"crook-0j8","title":"Make pkg/k8s tests deterministic and remove prod test helpers","description":"Background:\\n- pkg/k8s/client_test.go currently depends on host ~/.kube/config / in-cluster state, which can make tests pass/fail depending on the developer machine.\\n- pkg/k8s has unexported *test-only* helpers (e.g. newClientFromInterface*) living in non-_test.go files, which ships dead code in production builds.\\n\\nAcceptance criteria:\\n- Make TestBuildConfig deterministic by controlling HOME/KUBECONFIG and using a temp HOME without ~/.kube/config.\\n- Move newClientFromInterface/newClientFromClientset/newClientFromInterfaceWithConfig into a shared *_test.go helper (or internal testutil) so production build has no test scaffolding.\\n- Ensure go test ./... passes reliably on a machine that DOES have ~/.kube/config.\\n","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T19:45:30.820392578+11:00","created_by":"andri","updated_at":"2026-01-03T19:45:30.820392578+11:00"}
{"id":"crook-11d","title":"Add background refresh with goroutines","description":"Implement background monitoring with configurable refresh intervals.\n\nAcceptance Criteria:\n- StartMonitoring(ctx, config) starts background monitors\n- Each monitor runs in separate goroutine\n- Configurable refresh intervals (node: 2s, ceph: 5s, deployments: 2s)\n- Send updates via typed channels\n- Stop all monitors on context cancellation\n- Error handling: log and continue on failures\n\nContext:\nImplements specs/cluster-monitoring/spec.md 'Health Dashboard Refresh' requirement.\n\nImplementation Notes:\n- Use time.Ticker for refresh intervals\n- Graceful shutdown on context cancel\n- Error recovery without crashing monitors\n\nDeliverables:\n- Monitoring orchestration\n- Channel-based updates\n- Unit tests for lifecycle","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:57:20.720722606+11:00","created_by":"andri","updated_at":"2026-01-04T00:43:59.913140012+11:00","closed_at":"2026-01-04T00:43:59.913143659+11:00","dependencies":[{"issue_id":"crook-11d","depends_on_id":"crook-4w6","type":"parent-child","created_at":"2026-01-03T15:57:30.084635918+11:00","created_by":"andri"}]}
{"id":"crook-14o","title":"Implement 'crook state' commands","description":"Create state subcommands for JSON state files: list, show, clean. List shows JSON state files with metadata, clean removes old backups with --older-than flag.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:59:02.245453883+11:00","created_by":"andri","updated_at":"2026-01-04T14:26:12.389200517+11:00","closed_at":"2026-01-04T14:26:12.389200517+11:00","close_reason":"Implemented state list/show/clean commands with JSON/YAML/table output formats","dependencies":[{"issue_id":"crook-14o","depends_on_id":"crook-3yn","type":"parent-child","created_at":"2026-01-03T15:59:12.282827063+11:00","created_by":"andri"}]}
{"id":"crook-2eh","title":"Implement node operations (cordon/uncordon)","description":"Create pkg/k8s/nodes.go with node cordon and uncordon operations.\n\nAcceptance Criteria:\n- CordonNode(ctx, nodeName) sets .spec.unschedulable=true\n- UncordonNode(ctx, nodeName) sets .spec.unschedulable=false\n- GetNodeStatus(ctx, nodeName) returns node status and scheduling state\n- Verify node exists before operation\n- Return descriptive errors for node not found\n- Support context cancellation\n\nContext:\nImplements specs/kubernetes-client/spec.md 'Node Operations' requirement. Used in both down and up phases per specs/node-maintenance/spec.md.\n\nImplementation Notes:\n- Use clientset.CoreV1().Nodes().Get() and Patch()\n- Use JSON patch or strategic merge patch\n- Extract scheduling status from .spec.unschedulable and taints\n\nTest Cases:\n- Cordon existing node\n- Uncordon cordoned node\n- Node not found error\n- Context cancellation\n\nDeliverables:\n- pkg/k8s/nodes.go\n- Unit tests with fake clientset","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:53:47.781216982+11:00","created_by":"andri","updated_at":"2026-01-03T19:23:26.904309174+11:00","closed_at":"2026-01-03T19:23:26.904309174+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-2eh","depends_on_id":"crook-09q","type":"parent-child","created_at":"2026-01-03T15:54:01.504018928+11:00","created_by":"andri"},{"issue_id":"crook-2eh","depends_on_id":"crook-ku1","type":"blocks","created_at":"2026-01-03T18:09:42.023841185+11:00","created_by":"andri"}]}
{"id":"crook-2z6","title":"Write maintenance logic unit and integration tests","description":"Comprehensive test suite for maintenance orchestration.\n\nAcceptance Criteria:\n- Unit tests for discovery, validation, down, up, wait\n- Mock K8s client for unit tests\n- Integration tests with fake clientset for full workflows\n- Test error scenarios: failures at each step\n- Test context cancellation\n- Test timeout handling\n- Test state file creation on success only\n- Coverage \u003e80%\n\nContext:\nPer tasks.md sections 5.6-5.7. Ensures reliability of core business logic.\n\nTest Scenarios:\n- Successful down phase end-to-end\n- Successful up phase end-to-end\n- Down interrupted at various stages\n- Up with missing deployments\n- Timeout during wait\n- Context cancellation\n- Pre-flight validation failures\n\nDeliverables:\n- pkg/maintenance/*_test.go\n- Integration test suite\n- Test coverage report","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:56:29.177145198+11:00","created_by":"andri","updated_at":"2026-01-04T01:33:00.54318722+11:00","closed_at":"2026-01-04T01:33:00.543189465+11:00","dependencies":[{"issue_id":"crook-2z6","depends_on_id":"crook-42s","type":"parent-child","created_at":"2026-01-03T15:56:38.848460752+11:00","created_by":"andri"}]}
{"id":"crook-3qm","title":"ls Command Implementation","description":"Implement the crook ls command for interactive Ceph resource viewing in TUI. Includes tabbed views for nodes, deployments, OSDs, and pods with filtering, search, and multiple output formats.","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-04T16:56:16.317013563+11:00","created_by":"andri","updated_at":"2026-01-04T16:56:16.317013563+11:00"}
{"id":"crook-3qm.1","title":"Implement ls command CLI structure","description":"## Summary\nAdd the 'crook ls' subcommand to the Cobra CLI structure.\n\n## Implementation Details\n1. Create cmd/crook/commands/ls.go with:\n   - Command definition with usage: 'crook ls [node-name]'\n   - Optional positional arg for node filtering\n   - Flags: --watch/-w (bool), --refresh (int, default 2), --output/-o (string: tui|table|json|yaml), --all-namespaces/-A (bool), --show (string, comma-separated)\n   \n2. Wire into root.go command tree\n\n3. Flag validation:\n   - --refresh must be \u003e= 1 second\n   - --output must be one of: tui, table, json, yaml\n   - --show values must be subset of: nodes,deployments,osds,pods\n\n## Files to Create/Modify\n- CREATE: cmd/crook/commands/ls.go\n- CREATE: cmd/crook/commands/ls_test.go\n- MODIFY: cmd/crook/commands/root.go (add ls subcommand)\n\n## Dependencies\nNone - this is foundational\n\n## Parallelization\nCan be developed in parallel with crook-3qm.12, crook-3qm.13, crook-3qm.14 (Ceph query functions)\n\n## Acceptance Criteria\n- 'crook ls --help' shows all flags with descriptions\n- 'crook ls' with invalid --output value returns clear error\n- 'crook ls node-name' stores node filter for downstream use\n- Unit tests cover flag parsing and validation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T16:56:26.073683821+11:00","created_by":"andri","updated_at":"2026-01-04T17:09:36.038500786+11:00","closed_at":"2026-01-04T17:09:36.038500786+11:00","close_reason":"Implemented ls command CLI structure:\n- Created cmd/crook/commands/ls.go with full command definition\n- Added all flags: --watch/-w, --refresh, --output/-o, --all-namespaces/-A, --show\n- Implemented flag validation (refresh \u003e= 1, output enum, show values)\n- Wired into root.go command tree\n- Created comprehensive test suite in ls_test.go\n- All tests pass, linter clean, build succeeds","dependencies":[{"issue_id":"crook-3qm.1","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:56:26.076328895+11:00","created_by":"andri"}]}
{"id":"crook-3qm.10","title":"Implement node-filtered ls mode","description":"## Summary\nWhen user runs 'crook ls \u003cnode-name\u003e', pre-filter all views to show only resources related to that node.\n\n## Implementation Details\n1. CLI handling (in ls.go command):\n   - Parse positional argument as nodeFilter\n   - Validate node exists in cluster before launching TUI\n   - Pass nodeFilter to LsModel\n\n2. Node-filtered data fetching:\n   - Nodes view: Highlight/select the specified node, show all nodes\n   - Deployments view: Filter to deployments with pods on target node\n   - OSDs view: Filter to OSDs with hostname matching target node\n   - Pods view: Filter to pods with spec.nodeName = target node\n\n3. Header modifications:\n   - Show node-specific header: 'Node: worker-01 (Ready, Schedulable)'\n   - Include node's Ceph pod count\n   - Show node-specific warnings (cordoned, not ready)\n\n4. Data fetching changes:\n   - ListCephDeployments(ctx, namespace, prefixes, nodeFilter)\n   - GetOSDTree(ctx) with post-filter by hostname\n   - ListCephPods already supports nodeFilter\n\n5. Visual feedback:\n   - Tab titles show filtered counts: 'Deployments (3)' vs 'Deployments (3/15)'\n   - Clear indicator that view is node-filtered\n   - Option to clear node filter (maybe 'c' key?)\n\n## Files to Create/Modify\n- MODIFY: cmd/crook/commands/ls.go (parse and validate node arg)\n- MODIFY: pkg/tui/models/ls.go (accept and propagate nodeFilter)\n- MODIFY: pkg/tui/views/*.go (apply nodeFilter in data fetching)\n- MODIFY: pkg/k8s/deployments.go (add nodeFilter parameter)\n\n## Dependencies\n- crook-3qm.1 (CLI structure)\n- crook-3qm.2 (TUI model)\n- crook-3qm.4, 5, 6, 7 (all views must support filtering)\n\n## Parallelization\n- Can only start after views are implemented\n- Node validation logic can be developed early with crook-3qm.1\n\n## Acceptance Criteria\n- 'crook ls worker-01' shows only resources for worker-01\n- Invalid node name shows clear error before TUI launches\n- Header shows node-specific information\n- All views correctly filter by node\n- Tab counts reflect filtered totals\n- Unit tests for node-filtered queries","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T16:56:54.577200469+11:00","created_by":"andri","updated_at":"2026-01-04T17:01:39.870277865+11:00","dependencies":[{"issue_id":"crook-3qm.10","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:56:54.579456746+11:00","created_by":"andri"},{"issue_id":"crook-3qm.10","depends_on_id":"crook-3qm.4","type":"blocks","created_at":"2026-01-04T17:03:16.720388+11:00","created_by":"andri"},{"issue_id":"crook-3qm.10","depends_on_id":"crook-3qm.5","type":"blocks","created_at":"2026-01-04T17:03:16.741252719+11:00","created_by":"andri"},{"issue_id":"crook-3qm.10","depends_on_id":"crook-3qm.6","type":"blocks","created_at":"2026-01-04T17:03:16.762289183+11:00","created_by":"andri"},{"issue_id":"crook-3qm.10","depends_on_id":"crook-3qm.7","type":"blocks","created_at":"2026-01-04T17:03:16.783559109+11:00","created_by":"andri"}]}
{"id":"crook-3qm.11","title":"Implement alternative output formats","description":"## Summary\nAdd --output flag support for non-TUI output formats (table, json, yaml) for scripting and CI/CD integration.\n\n## Implementation Details\n1. Output format enum (pkg/tui/output/format.go):\n   ```go\n   type OutputFormat string\n   const (\n       FormatTUI   OutputFormat = \"tui\"\n       FormatTable OutputFormat = \"table\"\n       FormatJSON  OutputFormat = \"json\"\n       FormatYAML  OutputFormat = \"yaml\"\n   )\n   ```\n\n2. Non-TUI output path (in ls.go command):\n   - If --output != tui, skip Bubble Tea entirely\n   - Fetch all data synchronously\n   - Format and print to stdout\n   - Exit immediately\n\n3. Table format (pkg/tui/output/table.go):\n   - Use tablewriter or lipgloss table\n   - Respect --show flag for which resource types to include\n   - Section headers between resource types\n   - Color output if terminal supports it (detect via isatty)\n\n4. JSON format (pkg/tui/output/json.go):\n   - Structured output:\n     ```json\n     {\n       \"clusterHealth\": {...},\n       \"nodes\": [...],\n       \"deployments\": [...],\n       \"osds\": [...],\n       \"pods\": [...]\n     }\n     ```\n   - Pretty-printed by default, --compact flag for single-line (future)\n\n5. YAML format (pkg/tui/output/yaml.go):\n   - Same structure as JSON but YAML formatted\n   - Use gopkg.in/yaml.v3\n\n6. --show flag filtering:\n   - Parse comma-separated values: 'nodes,osds'\n   - Only fetch and output requested resource types\n   - Validate values against known types\n\n## Files to Create/Modify\n- CREATE: pkg/tui/output/format.go\n- CREATE: pkg/tui/output/table.go\n- CREATE: pkg/tui/output/json.go\n- CREATE: pkg/tui/output/yaml.go\n- CREATE: pkg/tui/output/output_test.go\n- MODIFY: cmd/crook/commands/ls.go (route to appropriate output)\n\n## Dependencies\n- crook-3qm.1 (CLI flags must be defined)\n- crook-3qm.4, 5, 6, 7 (data fetching functions needed)\n\n## Parallelization\n- Each output format can be developed in parallel\n- Can develop before TUI views are complete (just need data structures)\n\n## Acceptance Criteria\n- 'crook ls -o json' outputs valid JSON\n- 'crook ls -o yaml' outputs valid YAML\n- 'crook ls -o table' outputs aligned table\n- 'crook ls -o json --show nodes,osds' only includes those types\n- Exit code 0 on success, non-zero on errors\n- JSON/YAML parseable by jq/yq\n- Unit tests for each format","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T16:56:55.452550831+11:00","created_by":"andri","updated_at":"2026-01-04T17:01:59.002235399+11:00","dependencies":[{"issue_id":"crook-3qm.11","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:56:55.454811417+11:00","created_by":"andri"},{"issue_id":"crook-3qm.11","depends_on_id":"crook-3qm.1","type":"blocks","created_at":"2026-01-04T17:03:16.805563015+11:00","created_by":"andri"}]}
{"id":"crook-3qm.12","title":"Add Ceph flags query support","description":"## Summary\nImplement Ceph flags query to check noout, noin, nodown, noup, and other cluster flags.\n\n## Implementation Details\n1. Add to pkg/k8s/ceph.go:\n   ```go\n   type CephFlags struct {\n       NoOut       bool\n       NoIn        bool\n       NoDown      bool\n       NoUp        bool\n       NoRebalance bool\n       NoRecover   bool\n       NoScrub     bool\n       NoDeepScrub bool\n   }\n   \n   func (c *CephClient) GetCephFlags(ctx context.Context) (*CephFlags, error)\n   ```\n\n2. Implementation:\n   - Execute 'ceph osd dump --format json' via rook-ceph-tools\n   - Parse JSON response\n   - Extract flags from 'flags' field (space-separated string or array)\n   - Map to CephFlags struct\n\n3. JSON parsing (ceph osd dump excerpt):\n   ```json\n   {\n     \"flags\": \"noout,nodown,sortbitwise,recovery_deletes,purged_snapdirs,pglog_hardlimit\",\n     ...\n   }\n   ```\n\n4. Error handling:\n   - Return empty CephFlags (all false) if tools pod not available\n   - Log warning but don't fail if ceph command times out\n   - Wrap errors with context\n\n## Files to Create/Modify\n- MODIFY: pkg/k8s/ceph.go (add GetCephFlags function)\n- CREATE: pkg/k8s/ceph_flags_test.go\n\n## Dependencies\n- Existing: pkg/k8s/ceph.go ExecInToolsPod function\n\n## Parallelization\n- Can develop in parallel with crook-3qm.13, crook-3qm.14 (other Ceph queries)\n- Can develop in parallel with crook-3qm.1 (CLI structure)\n- No TUI dependencies\n\n## Test Fixtures Needed\n- test/fixtures/ceph_osd_dump.json (sample osd dump output)\n- test/fixtures/ceph_osd_dump_with_noout.json (with noout flag set)\n\n## Acceptance Criteria\n- GetCephFlags returns correct boolean values\n- noout flag correctly detected when set\n- Other flags (norebalance, noscrub) correctly parsed\n- Graceful handling of tools pod unavailability\n- Unit tests with JSON fixtures","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:57:06.116658261+11:00","created_by":"andri","updated_at":"2026-01-04T17:28:57.379797484+11:00","closed_at":"2026-01-04T17:28:57.379797484+11:00","close_reason":"Implemented Ceph flags query support:\n- Added CephFlags struct with all standard Ceph OSD flags (noout, noin, nodown, noup, norebalance, norecover, noscrub, nodeep-scrub, nobackfill, pause)\n- Implemented GetCephFlags() method using 'ceph osd dump --format json'\n- Added helper methods: HasMaintenanceFlags(), HasScrubFlags(), HasRecoveryFlags(), ActiveFlags()\n- Created test fixtures in test/fixtures/\n- Comprehensive unit tests for parsing and helper methods\n- All tests pass, linter clean","dependencies":[{"issue_id":"crook-3qm.12","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:57:06.118953762+11:00","created_by":"andri"}]}
{"id":"crook-3qm.13","title":"Add storage usage query","description":"## Summary\nImplement storage usage query using 'ceph df' command.\n\n## Implementation Details\n1. Add to pkg/k8s/ceph.go:\n   ```go\n   type StorageUsage struct {\n       TotalBytes     int64\n       UsedBytes      int64\n       AvailableBytes int64\n       UsedPercent    float64\n       Pools          []PoolUsage // optional, for detail view\n   }\n   \n   type PoolUsage struct {\n       Name       string\n       UsedBytes  int64\n       UsedPercent float64\n       MaxAvail   int64\n   }\n   \n   func (c *CephClient) GetStorageUsage(ctx context.Context) (*StorageUsage, error)\n   ```\n\n2. Implementation:\n   - Execute 'ceph df --format json' via rook-ceph-tools\n   - Parse JSON response\n   - Extract stats.total_bytes, stats.total_used_bytes, stats.total_avail_bytes\n   - Calculate percentage: used_bytes / total_bytes * 100\n   - Optionally extract per-pool stats from pools array\n\n3. JSON parsing (ceph df excerpt):\n   ```json\n   {\n     \"stats\": {\n       \"total_bytes\": 4398046511104,\n       \"total_used_bytes\": 1319413953433,\n       \"total_avail_bytes\": 3078632557671\n     },\n     \"pools\": [\n       {\n         \"name\": \"replicapool\",\n         \"stats\": {\n           \"stored\": 123456789,\n           \"percent_used\": 0.03,\n           \"max_avail\": 1000000000\n         }\n       }\n     ]\n   }\n   ```\n\n4. Human-readable formatting (pkg/tui/format/bytes.go):\n   - FormatBytes(bytes int64) string → '1.2 TiB', '500 GiB'\n   - Use binary units (TiB, GiB, MiB)\n\n## Files to Create/Modify\n- MODIFY: pkg/k8s/ceph.go (add GetStorageUsage function)\n- CREATE: pkg/k8s/ceph_df_test.go\n- CREATE: pkg/tui/format/bytes.go\n- CREATE: pkg/tui/format/bytes_test.go\n\n## Dependencies\n- Existing: pkg/k8s/ceph.go ExecInToolsPod function\n\n## Parallelization\n- Can develop in parallel with crook-3qm.12, crook-3qm.14 (other Ceph queries)\n- bytes.go formatter can be developed independently\n- No TUI dependencies\n\n## Test Fixtures Needed\n- test/fixtures/ceph_df.json (sample df output)\n\n## Acceptance Criteria\n- GetStorageUsage returns correct values\n- Percentage calculation accurate\n- Byte formatting produces human-readable output\n- Handles large values (petabytes) correctly\n- Graceful handling of tools pod unavailability\n- Unit tests with JSON fixtures","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:57:06.971779303+11:00","created_by":"andri","updated_at":"2026-01-04T17:32:01.038544169+11:00","closed_at":"2026-01-04T17:32:01.038544169+11:00","close_reason":"Implemented storage usage query:\n- Added StorageUsage and PoolUsage structs to represent ceph df output\n- Implemented GetStorageUsage() method using 'ceph df --format json'\n- Added helper methods: IsNearFull(), IsFull(), GetPoolByName()\n- Created pkg/tui/format/bytes.go with FormatBytes(), FormatBytesShort(), FormatBytesPrecise(), FormatPercent(), FormatStorageUsage() functions\n- Created test fixture test/fixtures/ceph_df.json\n- Comprehensive unit tests for parsing and byte formatting\n- All tests pass, linter clean, build succeeds","dependencies":[{"issue_id":"crook-3qm.13","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:57:06.974045679+11:00","created_by":"andri"}]}
{"id":"crook-3qm.14","title":"Add monitor quorum query","description":"## Summary\nImplement monitor quorum status query using 'ceph mon stat' command.\n\n## Implementation Details\n1. Add to pkg/k8s/ceph.go:\n   ```go\n   type MonitorStatus struct {\n       TotalCount    int\n       InQuorum      int\n       QuorumNames   []string\n       OutOfQuorum   []string\n       Leader        string\n       ElectionEpoch int\n   }\n   \n   func (c *CephClient) GetMonitorStatus(ctx context.Context) (*MonitorStatus, error)\n   ```\n\n2. Implementation:\n   - Execute 'ceph mon stat --format json' via rook-ceph-tools\n   - Parse JSON response\n   - Also consider 'ceph quorum_status --format json' for more detail\n\n3. JSON parsing (ceph mon stat excerpt):\n   ```json\n   {\n     \"epoch\": 3,\n     \"election_epoch\": 12,\n     \"quorum\": [0, 1, 2],\n     \"quorum_names\": [\"a\", \"b\", \"c\"],\n     \"leader\": \"a\",\n     \"num_mons\": 3\n   }\n   ```\n\n4. Out of quorum detection:\n   - Compare quorum_names with all known monitors\n   - Monitors not in quorum_names are out of quorum\n   - May need additional 'ceph mon dump' call to get full monitor list\n\n5. Error handling:\n   - If monitors are down, command may fail\n   - Return partial data if possible\n   - Log warnings for degraded state\n\n## Files to Create/Modify\n- MODIFY: pkg/k8s/ceph.go (add GetMonitorStatus function)\n- CREATE: pkg/k8s/ceph_mon_test.go\n\n## Dependencies\n- Existing: pkg/k8s/ceph.go ExecInToolsPod function\n\n## Parallelization\n- Can develop in parallel with crook-3qm.12, crook-3qm.13 (other Ceph queries)\n- No TUI dependencies\n\n## Test Fixtures Needed\n- test/fixtures/ceph_mon_stat.json (healthy quorum)\n- test/fixtures/ceph_mon_stat_degraded.json (mon out of quorum)\n\n## Acceptance Criteria\n- GetMonitorStatus returns correct quorum information\n- Leader correctly identified\n- Out-of-quorum monitors detected\n- Handles degraded cluster state gracefully\n- Unit tests with JSON fixtures","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T16:57:07.959957696+11:00","created_by":"andri","updated_at":"2026-01-04T17:02:42.744378239+11:00","dependencies":[{"issue_id":"crook-3qm.14","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:57:07.962266252+11:00","created_by":"andri"}]}
{"id":"crook-3qm.15","title":"Implement --watch continuous refresh mode","description":"## Summary\nAdd --watch/-w flag for continuous refresh mode, similar to the Unix 'watch' command.\n\n## Implementation Details\n1. Watch mode behavior:\n   - When --watch specified, TUI auto-refreshes at --refresh interval\n   - Default refresh interval: 2 seconds\n   - Non-TUI formats (table/json/yaml) clear screen and redraw\n   - Show 'Refreshing every Xs' in status bar\n\n2. TUI watch mode (pkg/tui/models/ls.go):\n   - Already has background refresh for header (5s)\n   - Add configurable refresh for all views\n   - Send periodic RefreshMsg via tea.Tick\n   - Show last refresh timestamp\n\n3. Non-TUI watch mode (pkg/tui/output/watch.go):\n   - Clear terminal (ANSI escape codes)\n   - Redraw output at specified interval\n   - Show timestamp header: 'Every 2.0s: crook ls    Sun Jan 4 12:00:00 2026'\n   - Handle Ctrl+C to exit cleanly\n\n4. Implementation:\n   ```go\n   func runWatch(ctx context.Context, interval time.Duration, fetchFn func() (Data, error), renderFn func(Data)) error {\n       ticker := time.NewTicker(interval)\n       defer ticker.Stop()\n       \n       for {\n           select {\n           case \u003c-ctx.Done():\n               return nil\n           case \u003c-ticker.C:\n               data, err := fetchFn()\n               if err != nil {\n                   // show error but continue\n               }\n               clearScreen()\n               renderFn(data)\n           }\n       }\n   }\n   ```\n\n5. Signal handling:\n   - Catch SIGINT (Ctrl+C) for clean exit\n   - Restore terminal state on exit\n\n## Files to Create/Modify\n- CREATE: pkg/tui/output/watch.go\n- CREATE: pkg/tui/output/watch_test.go\n- MODIFY: cmd/crook/commands/ls.go (add watch mode routing)\n- MODIFY: pkg/tui/models/ls.go (configurable refresh interval)\n\n## Dependencies\n- crook-3qm.1 (CLI flags)\n- crook-3qm.2 (TUI model)\n- crook-3qm.11 (non-TUI output formats)\n\n## Parallelization\n- Can develop after core ls functionality is working\n- Watch wrapper is mostly independent of view implementations\n\n## Acceptance Criteria\n- 'crook ls --watch' refreshes every 2 seconds\n- 'crook ls --watch --refresh 5' refreshes every 5 seconds\n- 'crook ls -o table --watch' clears and redraws table\n- Ctrl+C exits cleanly without terminal corruption\n- Timestamp shows last refresh time\n- Unit tests for watch loop logic","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-04T16:57:08.839895353+11:00","created_by":"andri","updated_at":"2026-01-04T17:03:00.227769695+11:00","dependencies":[{"issue_id":"crook-3qm.15","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:57:08.842166148+11:00","created_by":"andri"},{"issue_id":"crook-3qm.15","depends_on_id":"crook-3qm.2","type":"blocks","created_at":"2026-01-04T17:03:16.82630989+11:00","created_by":"andri"},{"issue_id":"crook-3qm.15","depends_on_id":"crook-3qm.11","type":"blocks","created_at":"2026-01-04T17:03:16.847108354+11:00","created_by":"andri"}]}
{"id":"crook-3qm.2","title":"Implement ls TUI model and tab navigation","description":"## Summary\nCreate the main Bubble Tea model for the ls command with tabbed navigation between resource views.\n\n## Implementation Details\n1. Create pkg/tui/models/ls.go with LsModel struct containing:\n   - activeTab int (0=Nodes, 1=Deployments, 2=OSDs, 3=Pods)\n   - nodeFilter string (optional, from CLI arg)\n   - filter string (from / search)\n   - filterActive bool\n   - Data slices for each resource type (populated by child views)\n   - cursor int (selected row in current view)\n   - detailMode bool (showing detail panel)\n   - width, height int (terminal dimensions)\n\n2. Implement tea.Model interface:\n   - Init(): Start background data fetchers, return initial Cmds\n   - Update(): Handle key messages (Tab, 1-4, j/k, Enter, r, /, q, Esc, ?)\n   - View(): Render header + tabs + active view + status bar\n\n3. Key bindings:\n   - Tab or 1-4: Switch tabs (cycle through or direct jump)\n   - j/k or ↑/↓: Navigate cursor in list\n   - Enter: Toggle detail view for selected resource\n   - r: Send refresh command to current view\n   - /: Enter filter mode (filterActive=true)\n   - q or Esc: Exit (or exit filter/detail mode if active)\n   - ?: Toggle help overlay\n\n4. Message types to define:\n   - TabSwitchMsg{tab int}\n   - RefreshMsg{}\n   - FilterMsg{query string}\n   - DataUpdateMsg{resourceType string, data interface{}}\n\n## Files to Create/Modify\n- CREATE: pkg/tui/models/ls.go\n- CREATE: pkg/tui/models/ls_test.go\n- CREATE: pkg/tui/components/tabs.go (tab bar component)\n- CREATE: pkg/tui/components/tabs_test.go\n\n## Dependencies\n- crook-3qm.1 (CLI structure must exist to launch this model)\n\n## Parallelization\n- Tab component (tabs.go) can be developed in parallel\n- View implementations (crook-3qm.4-7) can start once this skeleton exists\n- Header component (crook-3qm.3) can be developed in parallel\n\n## Acceptance Criteria\n- Tab switching works with Tab key and number keys\n- Keyboard navigation (j/k) moves cursor\n- Filter mode activates on / and deactivates on Esc\n- Terminal resize handled gracefully\n- Unit tests cover state transitions","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T16:56:26.905336084+11:00","created_by":"andri","updated_at":"2026-01-04T17:26:21.006566379+11:00","closed_at":"2026-01-04T17:26:21.006566379+11:00","close_reason":"Implemented ls TUI model and tab navigation:\n- Created pkg/tui/components/tabs.go with TabBar component for tab navigation\n- Created pkg/tui/models/ls.go with LsModel for the ls command TUI\n- Added keyboard navigation (j/k, g/G, Tab, 1-4 for tabs)\n- Added filter mode (/) with Enter to apply, Esc to cancel\n- Added help overlay (?) with all keybindings\n- Wired TUI model into cmd/crook/commands/ls.go runLs function\n- Created comprehensive test suites for both components\n- All tests pass, linter clean, build succeeds","dependencies":[{"issue_id":"crook-3qm.2","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:56:26.908199863+11:00","created_by":"andri"},{"issue_id":"crook-3qm.2","depends_on_id":"crook-3qm.1","type":"blocks","created_at":"2026-01-04T17:03:08.749668771+11:00","created_by":"andri"}]}
{"id":"crook-3qm.3","title":"Implement cluster summary header component","description":"## Summary\nCreate a header component displaying Ceph cluster health summary, refreshed every 5 seconds.\n\n## Implementation Details\n1. Create pkg/tui/components/header.go with ClusterHeader struct:\n   - health string (HEALTH_OK, HEALTH_WARN, HEALTH_ERR)\n   - healthMessages []string (if not OK)\n   - osdsUp, osdsTotal int\n   - osdsIn, osdsInTotal int  \n   - monsInQuorum, monsTotal int\n   - nooutSet bool\n   - usedBytes, totalBytes int64\n   - lastUpdate time.Time\n   - width int (for responsive rendering)\n\n2. Implement View() rendering:\n   - Row 1: 'Ceph: [HEALTH_OK]  OSDs: 5/5 up, 5/5 in  MONs: 3/3  noout: ✗'\n   - Row 2: 'Storage: 1.2 TiB / 4.0 TiB (30%)  Last updated: 2s ago'\n   - Color coding: green for OK, yellow for WARN, red for ERR\n   - Warning icon (⚠) next to noout if set\n\n3. Create pkg/tui/components/header_fetcher.go:\n   - Function to fetch all header data in one call\n   - Calls: GetCephHealth(), GetOSDStatus(), GetMonitorStatus(), GetCephFlags(), GetStorageUsage()\n   - Returns ClusterHeaderData struct\n   - Runs as background goroutine, sends HeaderUpdateMsg every 5s\n\n4. Lipgloss styling:\n   - Use styles from pkg/tui/styles/theme.go\n   - Responsive: collapse to single line if width \u003c 80\n\n## Files to Create/Modify\n- CREATE: pkg/tui/components/header.go\n- CREATE: pkg/tui/components/header_test.go\n- MODIFY: pkg/tui/styles/theme.go (add header styles if needed)\n\n## Dependencies\n- crook-3qm.12 (Ceph flags query)\n- crook-3qm.13 (Storage usage query)\n- crook-3qm.14 (Monitor quorum query)\n- Existing: pkg/k8s/ceph.go GetCephHealth()\n\n## Parallelization\n- Can develop header rendering in parallel with data fetchers\n- Mock data for initial development, wire real fetchers later\n\n## Acceptance Criteria\n- Header displays all required fields\n- Colors match health status\n- noout flag prominently displayed when set\n- Graceful degradation on narrow terminals\n- 'Last updated' shows time since last refresh\n- Unit tests cover rendering and color logic","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-04T16:56:27.749604307+11:00","created_by":"andri","updated_at":"2026-01-04T16:59:49.106825878+11:00","dependencies":[{"issue_id":"crook-3qm.3","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:56:27.751956376+11:00","created_by":"andri"},{"issue_id":"crook-3qm.3","depends_on_id":"crook-3qm.12","type":"blocks","created_at":"2026-01-04T17:03:08.771200011+11:00","created_by":"andri"},{"issue_id":"crook-3qm.3","depends_on_id":"crook-3qm.13","type":"blocks","created_at":"2026-01-04T17:03:08.791847998+11:00","created_by":"andri"},{"issue_id":"crook-3qm.3","depends_on_id":"crook-3qm.14","type":"blocks","created_at":"2026-01-04T17:03:08.813736906+11:00","created_by":"andri"}]}
{"id":"crook-3qm.4","title":"Implement node list view","description":"## Summary\nImplement the Nodes tab view showing all cluster nodes with Ceph workload information.\n\n## Implementation Details\n1. Create pkg/tui/views/nodes.go with NodesView struct:\n   - nodes []NodeInfo\n   - cursor int\n   - filter string\n   - width, height int\n\n2. NodeInfo struct (in pkg/tui/views/types.go):\n   - Name string\n   - Status string (Ready/NotReady/Unknown)\n   - Roles []string (control-plane, worker, etc.)\n   - Schedulable bool\n   - Cordoned bool\n   - CephPodCount int\n   - Age time.Duration\n   - KubeletVersion string\n\n3. Data fetching (pkg/k8s/nodes.go - extend existing):\n   - ListNodesWithCephPods(ctx, namespace, prefixes) []NodeInfo\n   - Query all nodes via client-go\n   - For each node, count pods matching deployment-filter prefixes\n   - Extract roles from labels 'node-role.kubernetes.io/*'\n   - Extract Ready condition from node.Status.Conditions\n\n4. Table rendering:\n   - Columns: NAME | STATUS | ROLES | SCHEDULE | CEPH PODS | AGE\n   - Highlight row at cursor position\n   - Cordoned nodes: show 'Cordoned' in yellow in SCHEDULE column\n   - Nodes with CephPodCount \u003e 0: subtle highlight\n   - Apply filter to Name column (case-insensitive contains)\n\n5. Bubble Tea integration:\n   - Implement Update() for cursor movement\n   - Implement View() with table rendering\n   - Send NodeSelectedMsg when Enter pressed\n\n## Files to Create/Modify\n- CREATE: pkg/tui/views/nodes.go\n- CREATE: pkg/tui/views/nodes_test.go\n- CREATE: pkg/tui/views/types.go (shared view types)\n- MODIFY: pkg/k8s/nodes.go (add ListNodesWithCephPods)\n- CREATE: pkg/k8s/nodes_ls_test.go\n\n## Dependencies\n- crook-3qm.2 (TUI model must exist to embed this view)\n\n## Parallelization\n- Can develop in parallel with crook-3qm.5, crook-3qm.6, crook-3qm.7 (other views)\n- K8s data fetching can be developed independently of view rendering\n\n## Acceptance Criteria\n- All cluster nodes displayed with correct status\n- Cordoned nodes visually distinct\n- Ceph pod count accurate per node\n- Cursor navigation works\n- Filter reduces visible rows\n- Unit tests for data fetching and rendering","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T16:56:38.997193793+11:00","created_by":"andri","updated_at":"2026-01-04T17:00:05.592428142+11:00","dependencies":[{"issue_id":"crook-3qm.4","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:56:38.999658987+11:00","created_by":"andri"},{"issue_id":"crook-3qm.4","depends_on_id":"crook-3qm.2","type":"blocks","created_at":"2026-01-04T17:03:08.83530188+11:00","created_by":"andri"}]}
{"id":"crook-3qm.5","title":"Implement deployment list view","description":"## Summary\nImplement the Deployments tab view showing Rook-Ceph deployments with node mapping.\n\n## Implementation Details\n1. Create pkg/tui/views/deployments.go with DeploymentsView struct:\n   - deployments []DeploymentInfo\n   - cursor int\n   - filter string\n   - groupByType bool (default true)\n   - width, height int\n\n2. DeploymentInfo struct (in pkg/tui/views/types.go):\n   - Name string\n   - Namespace string\n   - ReadyReplicas int\n   - DesiredReplicas int\n   - NodeName string (from pod spec)\n   - Age time.Duration\n   - Status string (Ready/Scaling/Unavailable)\n   - Type string (osd/mon/exporter/crashcollector)\n   - OsdId string (from label ceph-osd-id, if applicable)\n\n3. Data fetching (pkg/k8s/deployments.go - extend existing):\n   - ListCephDeployments(ctx, namespace, prefixes) []DeploymentInfo\n   - Query deployments matching prefixes\n   - For each deployment, find associated pods to get NodeName\n   - Extract type from deployment name prefix\n   - Determine status: Ready if ready==desired, Scaling if ready\u003cdesired \u0026\u0026 ready\u003e0, Unavailable if ready==0\n\n4. Table rendering:\n   - Columns: NAME | NAMESPACE | READY | NODE | AGE | STATUS\n   - Group by type with section headers: '── OSDs ──', '── Monitors ──', etc.\n   - Ready column format: '1/1' or '0/1' (current/desired)\n   - Status colors: green=Ready, yellow=Scaling, red=Unavailable\n   - Warning icon for 0-replica deployments (scaled down)\n\n5. Bubble Tea integration:\n   - Update() for cursor, respecting group boundaries\n   - View() with grouped table rendering\n   - DeploymentSelectedMsg on Enter\n\n## Files to Create/Modify\n- CREATE: pkg/tui/views/deployments.go\n- CREATE: pkg/tui/views/deployments_test.go\n- MODIFY: pkg/k8s/deployments.go (add ListCephDeployments)\n- CREATE: pkg/k8s/deployments_ls_test.go\n\n## Dependencies\n- crook-3qm.2 (TUI model must exist)\n- Existing: pkg/k8s/deployments.go (scale operations already exist)\n\n## Parallelization\n- Can develop in parallel with other views (crook-3qm.4, 6, 7)\n- Reuse existing deployment querying logic from maintenance operations\n\n## Acceptance Criteria\n- All Ceph deployments displayed, grouped by type\n- Ready/Desired replica counts accurate\n- Node association correct (via pod spec)\n- Scaled-down deployments (0 replicas) show warning\n- Status colors match deployment health\n- Unit tests for grouping logic and status determination","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T16:56:39.863691916+11:00","created_by":"andri","updated_at":"2026-01-04T17:00:21.562629605+11:00","dependencies":[{"issue_id":"crook-3qm.5","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:56:39.865994951+11:00","created_by":"andri"},{"issue_id":"crook-3qm.5","depends_on_id":"crook-3qm.2","type":"blocks","created_at":"2026-01-04T17:03:08.85638393+11:00","created_by":"andri"}]}
{"id":"crook-3qm.6","title":"Implement OSD list view","description":"## Summary\nImplement the OSDs tab view showing Ceph OSD status from ceph osd tree.\n\n## Implementation Details\n1. Create pkg/tui/views/osds.go with OSDsView struct:\n   - osds []OSDInfo\n   - cursor int\n   - filter string\n   - nooutSet bool (from cluster flags)\n   - width, height int\n\n2. OSDInfo struct (in pkg/tui/views/types.go):\n   - ID int (numeric OSD ID)\n   - Name string ('osd.0' format)\n   - Hostname string (from CRUSH tree)\n   - Status string ('up' or 'down')\n   - InOut string ('in' or 'out')\n   - Weight float64\n   - Reweight float64\n   - DeviceClass string (hdd/ssd/nvme)\n   - DeploymentName string (mapped from K8s)\n   - PGCount int (primary PGs, if available)\n\n3. Data fetching (pkg/k8s/ceph.go - extend existing):\n   - GetOSDTree(ctx) ([]OSDInfo, error)\n   - Execute 'ceph osd tree --format json' via rook-ceph-tools\n   - Parse JSON: navigate nodes array, extract type='osd' entries\n   - Map hostname from parent node with type='host'\n   - Cross-reference with K8s deployments: match osd.N to rook-ceph-osd-N deployment\n\n4. Table rendering:\n   - Columns: OSD | HOST | STATUS | IN/OUT | WEIGHT | DEPLOYMENT | PGs\n   - Status colors: green='up', red='down'\n   - In/Out colors: green='in', red='out'\n   - Show '(noout)' badge in header if cluster noout flag set\n   - Warning row highlight if down or out\n\n5. Bubble Tea integration:\n   - Standard cursor navigation\n   - OSDSelectedMsg on Enter (for detail view)\n\n## Files to Create/Modify\n- CREATE: pkg/tui/views/osds.go\n- CREATE: pkg/tui/views/osds_test.go\n- MODIFY: pkg/k8s/ceph.go (add GetOSDTree)\n- CREATE: pkg/k8s/ceph_osd_tree_test.go\n\n## Dependencies\n- crook-3qm.2 (TUI model)\n- crook-3qm.12 (Ceph flags query for noout status)\n- Existing: pkg/k8s/ceph.go (ExecInToolsPod already exists)\n\n## Parallelization\n- Can develop in parallel with other views\n- JSON parsing can be unit tested with fixture data independently\n\n## Test Fixtures Needed\n- test/fixtures/ceph_osd_tree.json (sample osd tree output)\n- test/fixtures/ceph_osd_tree_with_down.json (includes down OSDs)\n\n## Acceptance Criteria\n- All OSDs displayed with correct status\n- Hostname mapping from CRUSH tree accurate\n- Deployment cross-reference working\n- Down/out OSDs visually highlighted\n- noout flag status shown in view\n- Unit tests with JSON fixtures","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T16:56:40.782382341+11:00","created_by":"andri","updated_at":"2026-01-04T17:00:38.284800569+11:00","dependencies":[{"issue_id":"crook-3qm.6","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:56:40.784805906+11:00","created_by":"andri"},{"issue_id":"crook-3qm.6","depends_on_id":"crook-3qm.2","type":"blocks","created_at":"2026-01-04T17:03:08.877485366+11:00","created_by":"andri"},{"issue_id":"crook-3qm.6","depends_on_id":"crook-3qm.12","type":"blocks","created_at":"2026-01-04T17:03:08.915334725+11:00","created_by":"andri"}]}
{"id":"crook-3qm.7","title":"Implement pod list view","description":"## Summary\nImplement the Pods tab view showing Ceph-related pods with ownership information.\n\n## Implementation Details\n1. Create pkg/tui/views/pods.go with PodsView struct:\n   - pods []PodInfo\n   - cursor int\n   - filter string\n   - nodeFilter string (optional, from ls node arg)\n   - width, height int\n\n2. PodInfo struct (in pkg/tui/views/types.go):\n   - Name string\n   - Namespace string\n   - NodeName string\n   - Phase string (Running/Pending/Succeeded/Failed/Unknown)\n   - ReadyContainers int\n   - TotalContainers int\n   - RestartCount int\n   - Age time.Duration\n   - OwnerDeployment string (via ownership chain)\n\n3. Data fetching (pkg/k8s/pods.go - new file):\n   - ListCephPods(ctx, namespace, prefixes, nodeFilter) []PodInfo\n   - Query pods in namespace\n   - Filter by owner deployment name matching prefixes\n   - If nodeFilter set, add field selector spec.nodeName=nodeFilter\n   - Traverse ownership: Pod → ReplicaSet → Deployment (reuse existing logic from maintenance)\n   - Extract container ready counts from pod.Status.ContainerStatuses\n\n4. Table rendering:\n   - Columns: NAME | NAMESPACE | NODE | STATUS | READY | RESTARTS | AGE\n   - Ready format: '2/2' (ready/total containers)\n   - Status colors: green=Running, yellow=Pending, red=Failed\n   - High restart count (\u003e5) shown in yellow\n\n5. Bubble Tea integration:\n   - Standard cursor navigation\n   - PodSelectedMsg on Enter\n\n## Files to Create/Modify\n- CREATE: pkg/tui/views/pods.go\n- CREATE: pkg/tui/views/pods_test.go\n- CREATE: pkg/k8s/pods.go\n- CREATE: pkg/k8s/pods_test.go\n\n## Dependencies\n- crook-3qm.2 (TUI model)\n- Existing: pkg/k8s/deployments.go has ownership traversal logic to reuse\n\n## Parallelization\n- Can develop in parallel with other views (crook-3qm.4, 5, 6)\n- Ownership traversal logic already exists, can reuse\n\n## Acceptance Criteria\n- All Ceph pods displayed with correct ownership\n- Node filter works when ls called with node argument\n- Container ready counts accurate\n- Restart counts highlighted when high\n- Status colors match pod phase\n- Unit tests for data fetching and ownership traversal","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T16:56:41.697301055+11:00","created_by":"andri","updated_at":"2026-01-04T17:00:51.592334211+11:00","dependencies":[{"issue_id":"crook-3qm.7","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:56:41.699623678+11:00","created_by":"andri"},{"issue_id":"crook-3qm.7","depends_on_id":"crook-3qm.2","type":"blocks","created_at":"2026-01-04T17:03:08.937759457+11:00","created_by":"andri"}]}
{"id":"crook-3qm.8","title":"Implement resource detail view","description":"## Summary\nImplement the detail panel shown when user presses Enter on a selected resource.\n\n## Implementation Details\n1. Create pkg/tui/components/detail.go with DetailPanel struct:\n   - resourceType string (node/deployment/osd/pod)\n   - resource interface{} (NodeInfo/DeploymentInfo/OSDInfo/PodInfo)\n   - relatedResources []RelatedResource\n   - scrollOffset int\n   - width, height int\n\n2. RelatedResource struct:\n   - Type string\n   - Name string\n   - Status string\n\n3. Detail rendering by resource type:\n   \n   **Node Detail:**\n   - Full name, status, kubelet version\n   - Labels (key=value, one per line)\n   - Taints (if any)\n   - Conditions (Ready, MemoryPressure, DiskPressure, etc.)\n   - Related: Pods on this node, Deployments with pods here\n   \n   **Deployment Detail:**\n   - Full name, namespace\n   - Labels and annotations\n   - Replica status (desired, current, ready, available)\n   - Conditions (Available, Progressing)\n   - Strategy (RollingUpdate params)\n   - Related: Pods owned by this deployment\n   \n   **OSD Detail:**\n   - OSD ID, hostname\n   - Full CRUSH location (root → datacenter → rack → host)\n   - Device class, weight, reweight\n   - Status flags\n   - Related: K8s deployment, pod\n   \n   **Pod Detail:**\n   - Full name, namespace, node\n   - Labels and annotations\n   - Container statuses (name, ready, restarts, state)\n   - Events (last 5 events)\n   - Related: Owner deployment\n\n4. Bubble Tea integration:\n   - Scrollable content (j/k or ↑/↓ to scroll)\n   - Esc or q to close detail panel\n   - Width-responsive layout\n\n## Files to Create/Modify\n- CREATE: pkg/tui/components/detail.go\n- CREATE: pkg/tui/components/detail_test.go\n- MODIFY: pkg/tui/models/ls.go (integrate detail panel)\n\n## Dependencies\n- crook-3qm.2 (TUI model structure)\n- crook-3qm.4, 5, 6, 7 (view types must be defined)\n\n## Parallelization\n- Can start once types.go is created (part of crook-3qm.4)\n- Each resource type's detail rendering can be developed independently\n\n## Acceptance Criteria\n- Detail panel shows comprehensive information\n- Related resources listed with links\n- Scrollable for long content\n- Esc/q closes panel and returns to list\n- Responsive to terminal width\n- Unit tests for each resource type rendering","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T16:56:52.625996091+11:00","created_by":"andri","updated_at":"2026-01-04T17:01:07.989761579+11:00","dependencies":[{"issue_id":"crook-3qm.8","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:56:52.628310599+11:00","created_by":"andri"},{"issue_id":"crook-3qm.8","depends_on_id":"crook-3qm.4","type":"blocks","created_at":"2026-01-04T17:03:16.6776221+11:00","created_by":"andri"}]}
{"id":"crook-3qm.9","title":"Implement filter/search functionality","description":"## Summary\nImplement filter/search functionality triggered by / key.\n\n## Implementation Details\n1. Create pkg/tui/components/filterbar.go with FilterBar struct:\n   - query string\n   - cursorPos int\n   - active bool\n   - width int\n\n2. Filter mode behavior:\n   - Pressing / activates filter mode (active=true)\n   - Text input updates query string\n   - Backspace deletes characters\n   - Enter applies filter and exits filter mode (but keeps filter active)\n   - Esc clears filter and exits filter mode\n   - Ctrl+U clears query while staying in filter mode\n\n3. Filter application:\n   - Each view implements Filterable interface:\n     ```go\n     type Filterable interface {\n         ApplyFilter(query string)\n         ClearFilter()\n         FilteredCount() int\n         TotalCount() int\n     }\n     ```\n   - Filter matches against resource Name (case-insensitive contains)\n   - Views store both full list and filtered list\n\n4. Visual feedback:\n   - Filter bar appears at bottom when active: '/ filter: \u003cquery\u003e_'\n   - When filter applied but not active: status bar shows 'Filtered: \"\u003cquery\u003e\" (5/20)'\n   - Highlighted matches in resource names (optional enhancement)\n\n5. Bubble Tea integration:\n   - FilterBar handles its own key events when active\n   - Parent model delegates to FilterBar in filter mode\n   - FilterChangedMsg sent when filter updates\n\n## Files to Create/Modify\n- CREATE: pkg/tui/components/filterbar.go\n- CREATE: pkg/tui/components/filterbar_test.go\n- MODIFY: pkg/tui/models/ls.go (integrate filter bar)\n- MODIFY: pkg/tui/views/*.go (implement Filterable interface)\n\n## Dependencies\n- crook-3qm.2 (TUI model)\n- crook-3qm.4, 5, 6, 7 (views must exist to implement Filterable)\n\n## Parallelization\n- FilterBar component can be developed independently\n- Filterable interface can be added to views in parallel once defined\n\n## Acceptance Criteria\n- / activates filter mode with visible input bar\n- Typing updates filter in real-time\n- Esc clears filter completely\n- Enter keeps filter but exits input mode\n- Filter persists across tab switches\n- Status bar shows filter status and counts\n- Unit tests for filter bar input handling","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T16:56:53.509251851+11:00","created_by":"andri","updated_at":"2026-01-04T17:01:23.085897142+11:00","dependencies":[{"issue_id":"crook-3qm.9","depends_on_id":"crook-3qm","type":"parent-child","created_at":"2026-01-04T16:56:53.511504391+11:00","created_by":"andri"},{"issue_id":"crook-3qm.9","depends_on_id":"crook-3qm.2","type":"blocks","created_at":"2026-01-04T17:03:16.699384479+11:00","created_by":"andri"}]}
{"id":"crook-3sv","title":"Test cancellation handling (Ctrl+C scenarios)","description":"Comprehensive tests for context cancellation and graceful shutdown.\n\nAcceptance Criteria:\n- Test Ctrl+C during each phase of down/up\n- Verify cleanup on cancellation\n- Test timeout scenarios\n- Ensure no resource leaks\n- Test partial completion handling\n\nContext:\nPer tasks.md 9.7. Critical for safe interruption.\n\nDeliverables:\n- Cancellation test suite\n- Resource cleanup verification","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T15:59:41.177331125+11:00","created_by":"andri","updated_at":"2026-01-03T15:59:41.177331125+11:00","dependencies":[{"issue_id":"crook-3sv","depends_on_id":"crook-abg","type":"parent-child","created_at":"2026-01-03T15:59:47.68699345+11:00","created_by":"andri"}]}
{"id":"crook-3yn","title":"CLI Commands","description":"Cobra-based CLI with down/up/config/state commands and shell completion","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-03T15:52:01.589158919+11:00","created_by":"andri","updated_at":"2026-01-04T14:29:39.070630043+11:00","closed_at":"2026-01-04T14:29:39.070630043+11:00","close_reason":"All CLI commands implemented: root, down, up, version, completion, state (list/show/clean), config (show/validate)","dependencies":[{"issue_id":"crook-3yn","depends_on_id":"crook-51h","type":"blocks","created_at":"2026-01-03T15:59:12.322119214+11:00","created_by":"andri"},{"issue_id":"crook-3yn","depends_on_id":"crook-42s","type":"blocks","created_at":"2026-01-03T15:59:12.342139033+11:00","created_by":"andri"},{"issue_id":"crook-3yn","depends_on_id":"crook-57u","type":"blocks","created_at":"2026-01-03T15:59:12.361934657+11:00","created_by":"andri"},{"issue_id":"crook-3yn","depends_on_id":"crook-z1v","type":"blocks","created_at":"2026-01-03T15:59:12.381793201+11:00","created_by":"andri"}]}
{"id":"crook-41t","title":"Add retry logic with exponential backoff","description":"Implement retry wrapper for transient K8s API errors with exponential backoff.\n\nAcceptance Criteria:\n- Retry transient errors (network timeout, 500/503 errors) up to 3 times\n- Exponential backoff: 1s, 2s, 4s\n- Do not retry permanent errors (404, 403, 400)\n- Handle 429 rate limiting with Retry-After header\n- Configurable max retries and backoff parameters\n- Include retry count in error messages\n\nContext:\nImplements specs/kubernetes-client/spec.md 'Error Handling and Retries' requirement. Improves reliability in unstable network conditions.\n\nImplementation Notes:\n- Create pkg/k8s/retry.go with generic retry wrapper\n- Use k8s.io/apimachinery/pkg/api/errors for error type detection\n- Support context cancellation during retries\n- Log retry attempts at DEBUG level\n\nTest Cases:\n- Retry transient error and succeed\n- Retry transient error and fail after 3 attempts\n- Skip retry for 404 Not Found\n- Handle 429 with Retry-After\n- Context cancellation during retry\n\nDeliverables:\n- pkg/k8s/retry.go with WithRetry() wrapper\n- Unit tests for retry logic\n- Apply to all K8s client operations","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:53:52.845486928+11:00","created_by":"andri","updated_at":"2026-01-03T19:29:33.581186423+11:00","closed_at":"2026-01-03T19:29:33.581186423+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-41t","depends_on_id":"crook-09q","type":"parent-child","created_at":"2026-01-03T15:54:01.578815282+11:00","created_by":"andri"}]}
{"id":"crook-42s","title":"Core Maintenance Logic","description":"Down/up phase orchestration, deployment discovery, pre-flight validation (depends on K8s client, state, config)","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-03T15:51:56.873968629+11:00","created_by":"andri","updated_at":"2026-01-04T01:33:01.48892165+11:00","closed_at":"2026-01-04T01:33:01.488924546+11:00","dependencies":[{"issue_id":"crook-42s","depends_on_id":"crook-09q","type":"blocks","created_at":"2026-01-03T15:56:39.882014223+11:00","created_by":"andri"},{"issue_id":"crook-42s","depends_on_id":"crook-z1v","type":"blocks","created_at":"2026-01-03T15:56:39.905314016+11:00","created_by":"andri"},{"issue_id":"crook-42s","depends_on_id":"crook-57u","type":"blocks","created_at":"2026-01-03T15:56:39.924255444+11:00","created_by":"andri"}]}
{"id":"crook-43c","title":"Add godoc comments to all exported functions","description":"Comprehensive godoc documentation for all packages.\n\nAcceptance Criteria:\n- Package-level documentation for all packages\n- Function/method documentation for all exported symbols\n- Examples in godoc\n- Run godoc server and verify output\n- Pass golint checks for documentation\n\nContext:\nPer tasks.md 10.3.\n\nDeliverables:\n- Godoc comments throughout codebase\n- Package documentation","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T16:00:11.977391726+11:00","created_by":"andri","updated_at":"2026-01-03T16:00:11.977391726+11:00","dependencies":[{"issue_id":"crook-43c","depends_on_id":"crook-5a6","type":"parent-child","created_at":"2026-01-03T16:00:22.829167725+11:00","created_by":"andri"}]}
{"id":"crook-4dt","title":"Add benchmarks for performance-critical operations","description":"Benchmark tests for K8s client, parsing, and state operations.\n\nAcceptance Criteria:\n- Benchmark state file parsing\n- Benchmark K8s list operations with large result sets\n- Benchmark monitoring refresh loops\n- Establish baseline performance metrics\n- Identify bottlenecks if any\n\nContext:\nPer tasks.md 9.6.\n\nDeliverables:\n- Benchmark tests (*_bench_test.go)\n- Performance baseline documentation","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-03T15:59:39.994329722+11:00","created_by":"andri","updated_at":"2026-01-03T15:59:39.994329722+11:00","dependencies":[{"issue_id":"crook-4dt","depends_on_id":"crook-abg","type":"parent-child","created_at":"2026-01-03T15:59:47.667215981+11:00","created_by":"andri"}]}
{"id":"crook-4k5","title":"Implement up phase orchestration","description":"Create pkg/maintenance/up.go with complete up phase workflow (loads JSON state file and restores Deployments from resources where kind=Deployment).","acceptance_criteria":"- ExecuteUpPhase(ctx, config, nodeName) orchestrates full up sequence\n- Steps: load state → validate → restore deployments → scale operator → unset noout → uncordon\n- Load/parse JSON state file (v1) and validate required fields\n- Restore deployments from resources entries where kind=Deployment\n- Wait for each deployment to reach target replicas\n- Warn if deployments missing, prompt user\n- Progress callbacks for TUI integration\n- Context cancellation support","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:56:27.910211853+11:00","created_by":"andri","updated_at":"2026-01-04T01:29:07.812177331+11:00","closed_at":"2026-01-04T01:29:07.812179655+11:00","dependencies":[{"issue_id":"crook-4k5","depends_on_id":"crook-42s","type":"parent-child","created_at":"2026-01-03T15:56:38.812239186+11:00","created_by":"andri"},{"issue_id":"crook-4k5","depends_on_id":"crook-npb","type":"blocks","created_at":"2026-01-03T18:09:14.855674656+11:00","created_by":"andri"},{"issue_id":"crook-4k5","depends_on_id":"crook-82i","type":"blocks","created_at":"2026-01-03T18:09:14.878289629+11:00","created_by":"andri"}]}
{"id":"crook-4m1","title":"Implement 'crook config' commands","description":"Create config subcommands: show and validate.\n\nAcceptance Criteria:\n- 'crook config show' displays effective configuration\n- 'crook config validate' validates config file\n- Output format: YAML or JSON (--format flag)\n- Exit codes for validate command\n\nContext:\nPer tasks.md 8.4 and config issue crook-5sb.\n\nDependencies:\n- Requires config management (crook-57u)\n\nDeliverables:\n- cmd/crook/config.go\n- Subcommands: show, validate","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:59:00.945667206+11:00","created_by":"andri","updated_at":"2026-01-04T14:28:58.882847467+11:00","closed_at":"2026-01-04T14:28:58.882847467+11:00","close_reason":"Implemented config show and validate commands with YAML/JSON/text output formats","dependencies":[{"issue_id":"crook-4m1","depends_on_id":"crook-3yn","type":"parent-child","created_at":"2026-01-03T15:59:12.263073989+11:00","created_by":"andri"}]}
{"id":"crook-4w6","title":"Cluster Monitoring","description":"Real-time monitoring of node, Ceph health, OSDs, and deployments with background refresh","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-03T15:51:57.941943886+11:00","created_by":"andri","updated_at":"2026-01-04T00:44:11.874530482+11:00","closed_at":"2026-01-04T00:44:11.874532626+11:00","dependencies":[{"issue_id":"crook-4w6","depends_on_id":"crook-09q","type":"blocks","created_at":"2026-01-03T15:57:30.122736024+11:00","created_by":"andri"}]}
{"id":"crook-51h","title":"TUI Components","description":"Bubble Tea UI with state machines, progress tracking, dashboard, and keyboard navigation","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-03T15:51:59.054936139+11:00","created_by":"andri","updated_at":"2026-01-04T13:38:51.331295687+11:00","closed_at":"2026-01-04T13:38:51.331295687+11:00","close_reason":"All TUI components implemented:\n- Theme and styles with adaptive colors\n- Down/Up phase models with state machines  \n- Reusable components (confirm, progress, status, table)\n- Main app model with routing\n- Dashboard model for cluster health\n- Keyboard navigation and shortcuts\n- Terminal compatibility with fallbacks\n- Test coverage \u003e70% across all packages","dependencies":[{"issue_id":"crook-51h","depends_on_id":"crook-4w6","type":"blocks","created_at":"2026-01-03T15:58:30.281124035+11:00","created_by":"andri"},{"issue_id":"crook-51h","depends_on_id":"crook-42s","type":"blocks","created_at":"2026-01-03T15:58:30.301017856+11:00","created_by":"andri"}]}
{"id":"crook-53t","title":"Create EXAMPLES.md with common workflows","description":"Document common workflows and use cases.\n\nAcceptance Criteria:\n- Down phase example with screenshots/terminal output\n- Up phase example\n- Configuration examples\n- Multi-node scenarios (future)\n- Error recovery examples\n\nContext:\nPer tasks.md 10.2.\n\nDeliverables:\n- EXAMPLES.md\n- Example terminal output","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T16:00:10.747890253+11:00","created_by":"andri","updated_at":"2026-01-03T16:00:10.747890253+11:00","dependencies":[{"issue_id":"crook-53t","depends_on_id":"crook-5a6","type":"parent-child","created_at":"2026-01-03T16:00:22.807088947+11:00","created_by":"andri"}]}
{"id":"crook-57u","title":"Configuration Management","description":"Viper-based config with layered precedence (CLI flags, env vars, file, defaults)","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-03T15:51:55.76339648+11:00","created_by":"andri","updated_at":"2026-01-04T01:15:18.707065177+11:00","closed_at":"2026-01-04T01:15:18.707065177+11:00","close_reason":"Closed"}
{"id":"crook-5a6","title":"Documentation \u0026 Polish","description":"README, examples, godoc, contributing guide, CI/CD pipeline setup","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-03T15:52:04.020331079+11:00","created_by":"andri","updated_at":"2026-01-03T15:52:04.020331079+11:00","dependencies":[{"issue_id":"crook-5a6","depends_on_id":"crook-3yn","type":"blocks","created_at":"2026-01-03T16:00:22.911744828+11:00","created_by":"andri"}]}
{"id":"crook-5de","title":"Implement configuration validation","description":"Add comprehensive config validation with clear error messages.\n\nAcceptance Criteria:\n- Validate namespace names (non-empty, valid K8s format)\n- Validate file paths (kubeconfig exists if specified)\n- Validate state file template (only {{.Node}} placeholder)\n- Validate numeric ranges (timeouts \u003e=1s, refresh rates \u003e=100ms)\n- Validate deployment filter prefixes (non-empty array)\n- Return all validation errors, not just first\n- Warning vs error distinction (e.g., aggressive refresh is warning)\n\nContext:\nImplements specs/configuration/spec.md 'Configuration Validation' requirement.\n\nDeliverables:\n- ValidateConfig(config) function\n- Unit tests for each validation\n- Integration with loader","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:55:35.357803349+11:00","created_by":"andri","updated_at":"2026-01-03T23:23:46.967028043+11:00","closed_at":"2026-01-03T23:23:46.967028043+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-5de","depends_on_id":"crook-57u","type":"parent-child","created_at":"2026-01-03T15:55:45.414434634+11:00","created_by":"andri"}]}
{"id":"crook-5sb","title":"Implement config show and validate commands","description":"Add 'crook config show' and 'crook config validate' commands.\n\nAcceptance Criteria:\n- 'crook config show' displays merged config with source indicators\n- Shows which values came from: default, file, env, or flag\n- Masks sensitive values (tokens, if any)\n- 'crook config validate' runs validation and displays results\n- Exit code 0 if valid, 1 if invalid\n- YAML or JSON output format option\n\nContext:\nImplements specs/configuration/spec.md 'Configuration Display' requirement. Helps users debug config issues.\n\nImplementation Notes:\n- Use Viper's GetString/GetInt to show effective values\n- Track config sources (may need custom tracking)\n- Use color coding for source types in output\n\nDeliverables:\n- Cobra commands: config show, config validate\n- Pretty-printed output\n- Tests for command output","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:55:36.368030013+11:00","created_by":"andri","updated_at":"2026-01-04T14:28:59.840419359+11:00","closed_at":"2026-01-04T14:28:59.840419359+11:00","close_reason":"Implemented config show and validate commands with YAML/JSON/text output formats and exit codes","dependencies":[{"issue_id":"crook-5sb","depends_on_id":"crook-3yn","type":"parent-child","created_at":"2026-01-04T01:14:13.163961185+11:00","created_by":"andri"}]}
{"id":"crook-6el","title":"Create root command with Cobra","description":"Initialize Cobra CLI with root command, global flags, and setup.\n\nAcceptance Criteria:\n- cmd/crook/main.go with Cobra app initialization\n- Global flags: --config, --kubeconfig, --namespace, --log-level, --log-file\n- Load configuration on startup\n- Initialize logger\n- Version information\n- Graceful error handling\n\nContext:\nPer tasks.md 8.1. Entry point for CLI application.\n\nDeliverables:\n- cmd/crook/main.go\n- Root command setup\n- Global flag definitions","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:58:57.249608453+11:00","created_by":"andri","updated_at":"2026-01-04T14:20:39.88609948+11:00","closed_at":"2026-01-04T14:20:39.88609948+11:00","close_reason":"Root command already implemented with global flags, config loading, logger initialization, and signal handling. Tests pass.","dependencies":[{"issue_id":"crook-6el","depends_on_id":"crook-3yn","type":"parent-child","created_at":"2026-01-03T15:59:12.198222004+11:00","created_by":"andri"}]}
{"id":"crook-6mb","title":"Cutover \u0026 Cleanup","description":"Remove remaining bash-script-specific assumptions, verify Go feature parity where relevant, and prepare the project for release (binaries, docs, script removal).","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-03T15:52:05.183970693+11:00","created_by":"andri","updated_at":"2026-01-03T21:12:52.609939261+11:00","dependencies":[{"issue_id":"crook-6mb","depends_on_id":"crook-abg","type":"blocks","created_at":"2026-01-03T16:01:01.76096187+11:00","created_by":"andri"},{"issue_id":"crook-6mb","depends_on_id":"crook-5a6","type":"blocks","created_at":"2026-01-03T16:01:01.782602135+11:00","created_by":"andri"}]}
{"id":"crook-6n5","title":"Implement deployment status monitoring","description":"Create pkg/monitoring/deployments.go for deployment health monitoring.\n\nAcceptance Criteria:\n- MonitorDeployments(ctx, k8sClient, deployments) monitors deployment status\n- Track: desired, current, ready, available replicas\n- Deployment conditions (Available, Progressing)\n- Status indicators: Ready, Scaling, Unavailable\n- Refresh every 2 seconds\n- Aggregate status across all deployments\n\nContext:\nImplements specs/cluster-monitoring/spec.md 'Deployment Status Monitoring' requirement.\n\nDeliverables:\n- pkg/monitoring/deployments.go\n- Unit tests","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:57:18.060811885+11:00","created_by":"andri","updated_at":"2026-01-04T00:43:57.382548225+11:00","closed_at":"2026-01-04T00:43:57.382550359+11:00","dependencies":[{"issue_id":"crook-6n5","depends_on_id":"crook-4w6","type":"parent-child","created_at":"2026-01-03T15:57:30.047601113+11:00","created_by":"andri"}]}
{"id":"crook-6uq","title":"Create migration guide for users","description":"Document migration from bash script to Go (CLI/TUI), including the state file format change (JSON only; no TSV compatibility).","acceptance_criteria":"- Installation instructions\n- State file format notes: JSON (.json) only; no TSV compatibility\n- Command mapping (bash → Go)\n- Configuration migration guide\n- Guidance for operators who previously used TSV state files (re-run 'crook down' to generate JSON)\n- Rollback procedure","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T16:00:49.79030361+11:00","created_by":"andri","updated_at":"2026-01-03T21:13:29.796768335+11:00","dependencies":[{"issue_id":"crook-6uq","depends_on_id":"crook-6mb","type":"parent-child","created_at":"2026-01-03T16:01:01.676426067+11:00","created_by":"andri"}]}
{"id":"crook-6vo","title":"Implement keyboard navigation and shortcuts","description":"Add comprehensive keyboard controls for TUI navigation.\n\nAcceptance Criteria:\n- Global shortcuts: Ctrl+C (exit), ? (help), Enter (confirm), Esc (cancel)\n- Navigation: ↑/↓ for lists, y/n for prompts\n- Context-sensitive: r (retry in error state), l (toggle logs)\n- Help overlay showing all shortcuts\n- Disabled controls during in-progress operations (only Ctrl+C)\n\nContext:\nImplements specs/tui-interface/spec.md 'Keyboard Navigation' requirement.\n\nDeliverables:\n- Keyboard handling in all models\n- Help overlay component\n- Unit tests for key handling","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:58:20.793149956+11:00","created_by":"andri","updated_at":"2026-01-04T13:38:27.489846158+11:00","closed_at":"2026-01-04T13:38:27.489846158+11:00","close_reason":"Implemented keyboard navigation:\n- Global shortcuts: Ctrl+C (quit), ? (help), q (quit), Esc (cancel/close overlays)\n- Log view toggle with 'l' key  \n- Help overlay with full keyboard reference\n- Context-sensitive controls in sub-models (y/n prompts, r for retry)\n- All keys documented in help overlay","dependencies":[{"issue_id":"crook-6vo","depends_on_id":"crook-51h","type":"parent-child","created_at":"2026-01-03T15:58:30.217442316+11:00","created_by":"andri"}]}
{"id":"crook-77y","title":"Create Makefile with common tasks","description":"Makefile or justfile with build, test, lint, install targets.\n\nAcceptance Criteria:\n- make build - Build binary\n- make test - Run all tests\n- make lint - Run linters\n- make install - Install to GOPATH/bin\n- make clean - Clean build artifacts\n- Cross-compilation targets\n\nContext:\nPer tasks.md 10.6.\n\nDeliverables:\n- Makefile or justfile\n- Documentation in README","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T16:00:15.697149427+11:00","created_by":"andri","updated_at":"2026-01-03T16:00:15.697149427+11:00","dependencies":[{"issue_id":"crook-77y","depends_on_id":"crook-5a6","type":"parent-child","created_at":"2026-01-03T16:00:22.891492424+11:00","created_by":"andri"}]}
{"id":"crook-82i","title":"Add state file validation functions","description":"Implement comprehensive JSON state file validation before using for restoration. Validates JSON schema, field types, age, and deployment existence.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:54:55.905579074+11:00","created_by":"andri","updated_at":"2026-01-03T21:52:25.778013034+11:00","closed_at":"2026-01-03T21:52:25.778013034+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-82i","depends_on_id":"crook-z1v","type":"parent-child","created_at":"2026-01-03T15:55:03.350583257+11:00","created_by":"andri"}]}
{"id":"crook-853","title":"Create CONTRIBUTING.md and development setup","description":"Document development setup and contribution guidelines.\n\nAcceptance Criteria:\n- Development environment setup (devenv.nix, manual)\n- Building and testing locally\n- Code style guidelines\n- PR process\n- Release process\n\nContext:\nPer tasks.md 10.4.\n\nDeliverables:\n- CONTRIBUTING.md","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-03T16:00:13.210131255+11:00","created_by":"andri","updated_at":"2026-01-03T16:00:13.210131255+11:00","dependencies":[{"issue_id":"crook-853","depends_on_id":"crook-5a6","type":"parent-child","created_at":"2026-01-03T16:00:22.849881102+11:00","created_by":"andri"}]}
{"id":"crook-86k","title":"Implement pod operations and ownership traversal","description":"Create pkg/k8s/pods.go with pod listing and owner chain traversal.\n\nAcceptance Criteria:\n- ListPodsOnNode(ctx, nodeName) returns pods with field selector spec.nodeName=nodeName\n- GetOwnerChain(ctx, pod) traverses Pod → ReplicaSet → Deployment\n- ExecInPod(ctx, namespace, podName, command) executes command in pod\n- Return ownership chain as structured data\n- Handle pods without owners gracefully\n\nContext:\nImplements specs/kubernetes-client/spec.md 'Pod Operations' requirement. Needed for deployment discovery per specs/node-maintenance/spec.md 'Deployment Discovery'.\n\nImplementation Notes:\n- Use fieldSelector for efficient pod listing\n- Traverse ownerReferences recursively\n- For exec, use clientset.CoreV1().RESTClient().Post() with remotecommand\n- Support both discovery and Ceph command execution use cases\n\nTest Cases:\n- List pods on specific node\n- Traverse Pod → RS → Deployment\n- Traverse Pod → StatefulSet\n- Pod without owner\n- Exec command in pod\n\nDeliverables:\n- pkg/k8s/pods.go\n- Unit tests\n- Example usage in godoc","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:53:50.33247792+11:00","created_by":"andri","updated_at":"2026-01-03T19:25:58.207382503+11:00","closed_at":"2026-01-03T19:25:58.207382503+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-86k","depends_on_id":"crook-09q","type":"parent-child","created_at":"2026-01-03T15:54:01.541687708+11:00","created_by":"andri"},{"issue_id":"crook-86k","depends_on_id":"crook-ku1","type":"blocks","created_at":"2026-01-03T18:09:42.077526785+11:00","created_by":"andri"}]}
{"id":"crook-92f","title":"Collect early user feedback","description":"Share with early adopters and collect feedback.\n\nAcceptance Criteria:\n- Identify 2-3 early adopters\n- Provide release candidate\n- Collect feedback on usability, bugs, features\n- Address critical issues\n- Document feedback\n\nContext:\nPer tasks.md 12.5 (if applicable).\n\nDeliverables:\n- Feedback summary\n- Issue tracking for bugs found\n- Improvements for future versions","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T16:01:31.106725328+11:00","created_by":"andri","updated_at":"2026-01-03T16:01:31.106725328+11:00","dependencies":[{"issue_id":"crook-92f","depends_on_id":"crook-nr9","type":"parent-child","created_at":"2026-01-03T16:01:42.555721096+11:00","created_by":"andri"}]}
{"id":"crook-95s","title":"Write configuration unit tests","description":"Comprehensive test suite for config loading, merging, and validation.\n\nAcceptance Criteria:\n- Test default values\n- Test config file loading\n- Test env variable overrides\n- Test CLI flag overrides (integration with Cobra)\n- Test precedence order\n- Test partial configs\n- Test validation errors\n- Test coverage \u003e85%\n\nDeliverables:\n- pkg/config/*_test.go\n- Test fixtures with sample configs\n- Coverage report","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:55:36.5083176+11:00","created_by":"andri","updated_at":"2026-01-04T00:30:39.803987034+11:00","closed_at":"2026-01-04T00:30:39.803987034+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-95s","depends_on_id":"crook-57u","type":"parent-child","created_at":"2026-01-03T15:55:45.453186381+11:00","created_by":"andri"}]}
{"id":"crook-9ao","title":"Define configuration schema and types","description":"Create pkg/config/config.go with configuration schema matching specs/configuration/spec.md (state defaults use JSON state files).","acceptance_criteria":"- Config struct with sections: Kubernetes, State, DeploymentFilters, UI, Timeouts\n- Nested structs for each section\n- State config includes file-path-template default: ./crook-state-{{.Node}}.json\n- State config includes backup-enabled default: true and backup-directory default per spec\n- Validation tags for required fields\n- String() method for display","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:55:32.995245429+11:00","created_by":"andri","updated_at":"2026-01-03T23:23:46.956900837+11:00","closed_at":"2026-01-03T23:23:46.956900837+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-9ao","depends_on_id":"crook-57u","type":"parent-child","created_at":"2026-01-03T15:55:45.374367923+11:00","created_by":"andri"}]}
{"id":"crook-9bk","title":"Tag v1.0.0 release","description":"Create official v1.0.0 release with artifacts.\n\nAcceptance Criteria:\n- All validation complete\n- All tests passing\n- Documentation complete\n- Tag git commit as v1.0.0\n- Create GitHub release\n- Upload binaries and checksums\n- Announce release\n\nContext:\nPer tasks.md 12.7. Official release milestone.\n\nDependencies:\n- All previous validation issues complete\n\nDeliverables:\n- Git tag v1.0.0\n- GitHub release with binaries\n- Release notes\n- Announcement","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-03T16:01:34.528831633+11:00","created_by":"andri","updated_at":"2026-01-03T16:01:34.528831633+11:00","dependencies":[{"issue_id":"crook-9bk","depends_on_id":"crook-nr9","type":"parent-child","created_at":"2026-01-03T16:01:42.598627994+11:00","created_by":"andri"}]}
{"id":"crook-9ir","title":"Implement 'crook down' command","description":"Create 'crook down \u003cnode\u003e' command for down phase (writes a .json state file by default).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:58:58.616154047+11:00","created_by":"andri","updated_at":"2026-01-04T14:20:40.998713588+11:00","closed_at":"2026-01-04T14:20:40.998713588+11:00","close_reason":"Down command already implemented with TUI and non-interactive modes, state file handling, timeout support, and progress callbacks. Tests pass.","dependencies":[{"issue_id":"crook-9ir","depends_on_id":"crook-3yn","type":"parent-child","created_at":"2026-01-03T15:59:12.222749881+11:00","created_by":"andri"}]}
{"id":"crook-9oh","title":"Write state persistence unit tests","description":"Comprehensive test suite for state persistence using JSON v1 format (no legacy TSV compatibility). Cover parsing, writing invariants (pretty printing + determinism), validation, backups, and path resolution where applicable.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:54:56.081732177+11:00","created_by":"andri","updated_at":"2026-01-03T23:05:42.526718798+11:00","closed_at":"2026-01-03T23:05:42.526718798+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-9oh","depends_on_id":"crook-z1v","type":"parent-child","created_at":"2026-01-03T15:55:03.369918534+11:00","created_by":"andri"}]}
{"id":"crook-abg","title":"Integration \u0026 Testing","description":"End-to-end tests, integration tests, terminal compatibility, and performance benchmarks","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-03T15:52:02.868508055+11:00","created_by":"andri","updated_at":"2026-01-03T15:52:02.868508055+11:00","dependencies":[{"issue_id":"crook-abg","depends_on_id":"crook-3yn","type":"blocks","created_at":"2026-01-03T15:59:47.707743193+11:00","created_by":"andri"}]}
{"id":"crook-axa","title":"Add wait operations with timeout","description":"Implement robust waiting for async K8s operations with configurable timeouts.\n\nAcceptance Criteria:\n- WaitForDeploymentScaleDown(ctx, deployment, timeout) polls until readyReplicas=0\n- WaitForDeploymentScaleUp(ctx, deployment, targetReplicas, timeout) polls until replicas=target\n- Poll interval: 5 seconds (configurable)\n- Default timeout: 300 seconds\n- Return detailed error on timeout with current state\n- Context cancellation support\n- Progress updates via callback\n\nContext:\nImplements specs/node-maintenance/spec.md 'Wait Operations' requirement. Critical for reliable operation completion.\n\nDependencies:\n- Requires deployment operations from K8s client\n\nImplementation Notes:\n- Use time.NewTicker for polling\n- Return current state on timeout for debugging\n- Allow custom poll interval and timeout\n\nDeliverables:\n- WaitFor* functions in pkg/maintenance/wait.go\n- Unit tests with time manipulation\n- Timeout handling tests","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:56:28.997083359+11:00","created_by":"andri","updated_at":"2026-01-04T01:24:40.57195942+11:00","closed_at":"2026-01-04T01:24:40.571961904+11:00","dependencies":[{"issue_id":"crook-axa","depends_on_id":"crook-42s","type":"parent-child","created_at":"2026-01-03T15:56:38.830272742+11:00","created_by":"andri"}]}
{"id":"crook-axk","title":"Add JSON state fixtures and formatting tests","description":"Create fixtures and tests that validate JSON state file parsing/writing matches the OpenSpec state-persistence requirements (pretty printing, deterministic output, validation).","acceptance_criteria":"- Add sample JSON state file fixtures (v1)\n- Add tests for parsing valid fixtures\n- Add tests for malformed JSON and missing required fields\n- Add tests that writer output is 2-space indented and ends with a trailing newline\n- Add tests that resources are sorted deterministically (namespace, then name)\n- Document the fixture shape and expected invariants","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T15:59:39.063501653+11:00","created_by":"andri","updated_at":"2026-01-03T21:13:06.117499181+11:00","dependencies":[{"issue_id":"crook-axk","depends_on_id":"crook-abg","type":"parent-child","created_at":"2026-01-03T15:59:47.64740583+11:00","created_by":"andri"}]}
{"id":"crook-b24","title":"Create TUI theme and styles","description":"Create pkg/tui/styles/theme.go with color palette and text styles.\n\nAcceptance Criteria:\n- Color palette: primary, success (green), warning (yellow), error (red), info (blue)\n- Text styles: heading, normal, status, error\n- Border styles for boxes\n- Support 256-color and 16-color fallback\n- Consistent styling across all TUI components\n\nContext:\nPer tasks.md 7.1 and specs/tui-interface/spec.md 'Terminal Compatibility'.\n\nDeliverables:\n- pkg/tui/styles/theme.go\n- Color detection and fallback\n- Style constants","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:58:13.510844651+11:00","created_by":"andri","updated_at":"2026-01-04T01:42:27.219538386+11:00","closed_at":"2026-01-04T01:42:27.219542594+11:00","dependencies":[{"issue_id":"crook-b24","depends_on_id":"crook-51h","type":"parent-child","created_at":"2026-01-03T15:58:30.095944199+11:00","created_by":"andri"}]}
{"id":"crook-bvf","title":"Perform manual end-to-end testing","description":"Manual testing of complete workflows in real environment.\n\nAcceptance Criteria:\n- Test down phase on real/test cluster\n- Test up phase on real/test cluster\n- Test error scenarios (network failures, invalid inputs)\n- Test TUI interactions (keyboard, resize, colors)\n- Test with different configurations\n- Document results\n\nContext:\nPer tasks.md 12.4. Final verification before release.\n\nDeliverables:\n- Test plan\n- Test execution report\n- Bug list (if any)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T16:01:29.724148352+11:00","created_by":"andri","updated_at":"2026-01-03T16:01:29.724148352+11:00","dependencies":[{"issue_id":"crook-bvf","depends_on_id":"crook-nr9","type":"parent-child","created_at":"2026-01-03T16:01:42.534386913+11:00","created_by":"andri"}]}
{"id":"crook-byx","title":"Run OpenSpec strict validation","description":"Validate all specs and change proposal with strict mode.\n\nAcceptance Criteria:\n- Run 'openspec validate add-go-tui-interface --strict'\n- All validation checks pass\n- No errors or warnings\n- Verify all requirements have corresponding code\n- Verify all scenarios are tested\n\nContext:\nPer tasks.md 12.1 and OpenSpec workflow.\n\nDeliverables:\n- Clean validation report\n- Fixed any issues found","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T16:01:27.652138685+11:00","created_by":"andri","updated_at":"2026-01-03T16:01:27.652138685+11:00","dependencies":[{"issue_id":"crook-byx","depends_on_id":"crook-nr9","type":"parent-child","created_at":"2026-01-03T16:01:42.487016784+11:00","created_by":"andri"}]}
{"id":"crook-cfg","title":"Migrate from deprecated fake.NewSimpleClientset to fake.NewClientset","description":"## Summary\nThe Kubernetes client-go library has deprecated `fake.NewSimpleClientset()` in favor of `fake.NewClientset()`. The new function provides better support for Server-Side Apply (SSA) testing with field management.\n\n## Current State\n- Using `fake.NewSimpleClientset()` in test files\n- Added `//nolint:staticcheck` comments to suppress SA1019 warnings\n- Tests work correctly for current use cases (no SSA)\n\n## Files Affected\n- `pkg/maintenance/validator_test.go`\n- `pkg/maintenance/wait_test.go`\n- `pkg/monitoring/ceph_test.go`\n- `pkg/monitoring/deployments_test.go`\n- `pkg/monitoring/monitor_test.go`\n- `pkg/monitoring/node_test.go`\n\n## Migration Steps\n1. Set up Kubernetes code generation tooling (controller-gen or client-gen)\n2. Generate apply configurations with `--with-applyconfig` flag\n3. Add generated `applyconfiguration` package to the project\n4. Replace `fake.NewSimpleClientset()` with `fake.NewClientset()`\n5. Remove `//nolint:staticcheck` comments\n6. Update `.golangci.yml` if needed\n\n## When to Prioritize\nConsider prioritizing this if:\n- The project starts using Server-Side Apply\n- Testing field ownership/conflicts becomes necessary\n- Building Kubernetes controllers with SSA\n\n## References\n- [client-go fake package](https://pkg.go.dev/k8s.io/client-go/kubernetes/fake)\n- [Server-Side Apply documentation](https://kubernetes.io/docs/reference/using-api/server-side-apply/)","status":"open","priority":4,"issue_type":"chore","created_at":"2026-01-04T12:08:10.131616614+11:00","created_by":"andri","updated_at":"2026-01-04T12:08:10.131616614+11:00"}
{"id":"crook-cig","title":"Write TUI component tests","description":"Test suite for TUI models and components.\n\nAcceptance Criteria:\n- Unit tests for all models (dashboard, down, up, app)\n- Test state machine transitions\n- Test keyboard input handling\n- Test component rendering (snapshot tests)\n- Test error states and retry logic\n- Coverage \u003e70% (lower due to view rendering)\n\nDeliverables:\n- pkg/tui/models/*_test.go\n- pkg/tui/components/*_test.go\n- Snapshot tests for views","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:58:22.17951661+11:00","created_by":"andri","updated_at":"2026-01-04T13:38:33.271595152+11:00","closed_at":"2026-01-04T13:38:33.271595152+11:00","close_reason":"TUI test coverage achieved:\n- components: 81.2% (\u003e70% requirement)\n- models: 76.4% (\u003e70% requirement)\n- Terminal: 97.5%\nTests cover state machine transitions, keyboard handling, view rendering, and error states.","dependencies":[{"issue_id":"crook-cig","depends_on_id":"crook-51h","type":"parent-child","created_at":"2026-01-03T15:58:30.257898997+11:00","created_by":"andri"}]}
{"id":"crook-cjz","title":"Foundation \u0026 Project Setup","description":"Initialize Go module, project structure, dependencies, and basic utilities","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-03T15:51:35.847139335+11:00","created_by":"andri","updated_at":"2026-01-03T19:11:23.659403686+11:00","closed_at":"2026-01-03T19:11:23.659403686+11:00","close_reason":"Closed"}
{"id":"crook-cnj","title":"Harden retry logic (errors.As, narrower retry set, testable backoff)","description":"Background:\\n- pkg/k8s/retry.go treats any non-*errors.StatusError as retryable, which can retry programmer/validation errors and hide real failures.\\n- Type assertions should use errors.As because k8s errors are often wrapped.\\n- Backoff uses time.After directly, making timing tests flaky and behavior hard to test deterministically.\\n\\nAcceptance criteria:\\n- Use errors.Is / errors.As for context cancellation + StatusError detection.\\n- Retry only well-defined transient classes (timeouts, temporary net errors, 5xx, 429/408); do not blindly retry all generic errors.\\n- Replace ParseRetryAfterHeader RFC1123-only parsing with http.ParseTime.\\n- Make backoff/sleep injectable so tests can validate retry schedule without wall-clock timing.\\n- Keep public API stable (WithRetry / RetryConfig).\\n","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T19:45:34.833051793+11:00","created_by":"andri","updated_at":"2026-01-03T19:45:34.833051793+11:00"}
{"id":"crook-dvs","title":"Implement JSON format parser","description":"Create JSON parser using encoding/json for v1 JSON state format with Resources array.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:54:52.381552882+11:00","created_by":"andri","updated_at":"2026-01-03T21:46:01.526852687+11:00","closed_at":"2026-01-03T21:46:01.526852687+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-dvs","depends_on_id":"crook-z1v","type":"parent-child","created_at":"2026-01-03T15:55:03.294684038+11:00","created_by":"andri"},{"issue_id":"crook-dvs","depends_on_id":"crook-umx","type":"blocks","created_at":"2026-01-03T18:09:28.722586925+11:00","created_by":"andri"}]}
{"id":"crook-egi","title":"Create up phase model with state machine","description":"Build Bubble Tea model for up phase with state machine transitions.\n\nAcceptance Criteria:\n- States: Init → Confirm → RestoringDeployments → ScalingOperator → UnsettingNoOut → Uncordoning → Complete\n- Display restore plan from state file\n- Progress tracking for each operation\n- Handle missing deployments with user prompt\n- Final success summary\n\nContext:\nImplements specs/tui-interface/spec.md 'Up Phase Interactive Workflow'. Per design.md lines 190-198.\n\nDependencies:\n- Requires maintenance up orchestration (crook-4k5)\n- Requires state file loading\n\nDeliverables:\n- pkg/tui/models/up.go\n- State machine logic\n- Integration with up phase callbacks","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:58:18.595362582+11:00","created_by":"andri","updated_at":"2026-01-04T13:18:51.706234936+11:00","closed_at":"2026-01-04T13:18:51.706234936+11:00","close_reason":"Implemented in commit ecc2b59 - up phase model with complete state machine","dependencies":[{"issue_id":"crook-egi","depends_on_id":"crook-51h","type":"parent-child","created_at":"2026-01-03T15:58:30.17893988+11:00","created_by":"andri"},{"issue_id":"crook-egi","depends_on_id":"crook-j6g","type":"blocks","created_at":"2026-01-03T18:09:21.09782043+11:00","created_by":"andri"}]}
{"id":"crook-ekz","title":"Create example configuration file","description":"Create crook.yaml.example with all configuration options documented.\n\nAcceptance Criteria:\n- File contains all sections: kubernetes, state, deployment-filters, ui, timeouts\n- Each option has inline comment explaining purpose\n- Default values shown\n- Template variables documented (e.g., {{.Node}})\n- Well-formatted YAML\n\nContext:\nPer design.md Configuration section and specs/configuration/spec.md. This serves as both example and documentation for users.\n\nTemplate based on design.md lines 124-145.\n\nDeliverables:\n- crook.yaml.example file\n- All options from config spec included","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:52:39.228868+11:00","created_by":"andri","updated_at":"2026-01-03T19:11:22.729040883+11:00","closed_at":"2026-01-03T19:11:22.729040883+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-ekz","depends_on_id":"crook-cjz","type":"parent-child","created_at":"2026-01-03T15:52:51.628128253+11:00","created_by":"andri"}]}
{"id":"crook-exb","title":"Write monitoring unit tests","description":"Test suite for all monitoring components.\n\nAcceptance Criteria:\n- Unit tests for node, ceph, OSD, deployment monitors\n- Mock K8s client and Ceph command output\n- Test JSON parsing with real ceph output samples\n- Test refresh loops with time manipulation\n- Test error handling and recovery\n- Test aggregation logic\n- Coverage \u003e80%\n\nDeliverables:\n- pkg/monitoring/*_test.go\n- Test fixtures with Ceph JSON samples\n- Coverage report","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:57:20.904463129+11:00","created_by":"andri","updated_at":"2026-01-04T00:44:00.949876969+11:00","closed_at":"2026-01-04T00:44:00.949880676+11:00","dependencies":[{"issue_id":"crook-exb","depends_on_id":"crook-4w6","type":"parent-child","created_at":"2026-01-03T15:57:30.103735605+11:00","created_by":"andri"}]}
{"id":"crook-fmx","title":"Implement Ceph health monitoring","description":"Create pkg/monitoring/ceph.go for Ceph cluster health monitoring.\n\nAcceptance Criteria:\n- MonitorCephHealth(ctx, k8sClient, namespace) returns parsed Ceph status\n- Execute 'ceph status --format json' and parse\n- Extract: overall health, health messages, OSD/mon counts, data usage, PG states\n- Health indicators: OK=green, WARN=yellow, ERR=red\n- Refresh every 5 seconds\n- Handle rook-ceph-tools not available\n\nContext:\nImplements specs/cluster-monitoring/spec.md 'Ceph Cluster Health Monitoring' requirement.\n\nDependencies:\n- Requires Ceph command execution from K8s client\n\nDeliverables:\n- pkg/monitoring/ceph.go\n- JSON parsing for ceph status\n- Unit tests with mocked output","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:57:14.42479778+11:00","created_by":"andri","updated_at":"2026-01-04T00:43:55.024782219+11:00","closed_at":"2026-01-04T00:43:55.024784403+11:00","dependencies":[{"issue_id":"crook-fmx","depends_on_id":"crook-4w6","type":"parent-child","created_at":"2026-01-03T15:57:30.009800916+11:00","created_by":"andri"}]}
{"id":"crook-h41","title":"Implement state file backup functionality","description":"Add backup creation before overwriting existing JSON state files. Backup filename: \u003coriginal\u003e.backup.\u003cRFC3339\u003e.json. No legacy TSV support.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:54:54.698007719+11:00","created_by":"andri","updated_at":"2026-01-03T21:52:25.7727912+11:00","closed_at":"2026-01-03T21:52:25.7727912+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-h41","depends_on_id":"crook-z1v","type":"parent-child","created_at":"2026-01-03T15:55:03.332247264+11:00","created_by":"andri"}]}
{"id":"crook-hce","title":"Address validation issues and polish","description":"Fix any issues found during validation phase.\n\nAcceptance Criteria:\n- All bugs from manual testing fixed\n- All validation errors resolved\n- Code cleanup and polish\n- Final code review\n- All tests passing\n\nContext:\nPer tasks.md 12.6.\n\nDeliverables:\n- Bug fixes\n- Code cleanup\n- Final review sign-off","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T16:01:33.146786019+11:00","created_by":"andri","updated_at":"2026-01-03T16:01:33.146786019+11:00","dependencies":[{"issue_id":"crook-hce","depends_on_id":"crook-nr9","type":"parent-child","created_at":"2026-01-03T16:01:42.576966482+11:00","created_by":"andri"}]}
{"id":"crook-i4e","title":"Create down phase model with state machine","description":"Build Bubble Tea model for down phase with state machine transitions.\n\nAcceptance Criteria:\n- States: Init → Confirm → Cordoning → SettingNoOut → ScalingOperator → DiscoveringDeployments → ScalingDeployments → Complete\n- Progress tracking for each async operation\n- Error state with retry/abort options\n- Context propagation for cancellation\n- Confirmation prompt showing impact\n- Final summary with state file path\n\nContext:\nImplements specs/tui-interface/spec.md 'Down Phase Interactive Workflow'. Per design.md lines 179-188.\n\nDependencies:\n- Requires maintenance down orchestration (crook-kis)\n- Requires TUI components\n\nDeliverables:\n- pkg/tui/models/down.go\n- State machine logic\n- Integration with down phase callbacks","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:58:17.279295851+11:00","created_by":"andri","updated_at":"2026-01-04T13:18:50.5190049+11:00","closed_at":"2026-01-04T13:18:50.5190049+11:00","close_reason":"Implemented in commit 72a5b0c - down phase model with complete state machine","dependencies":[{"issue_id":"crook-i4e","depends_on_id":"crook-51h","type":"parent-child","created_at":"2026-01-03T15:58:30.158945147+11:00","created_by":"andri"},{"issue_id":"crook-i4e","depends_on_id":"crook-j6g","type":"blocks","created_at":"2026-01-03T18:09:21.071458127+11:00","created_by":"andri"}]}
{"id":"crook-im4","title":"Implement state file path resolution with templates","description":"Add path resolution supporting {{.Node}} template substitution, path expansion, and .json extension. Default template: ./crook-state-{{.Node}}.json","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:54:53.532262604+11:00","created_by":"andri","updated_at":"2026-01-03T21:46:01.531794227+11:00","closed_at":"2026-01-03T21:46:01.531794227+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-im4","depends_on_id":"crook-z1v","type":"parent-child","created_at":"2026-01-03T15:55:03.314052319+11:00","created_by":"andri"},{"issue_id":"crook-im4","depends_on_id":"crook-umx","type":"blocks","created_at":"2026-01-03T18:09:28.745188204+11:00","created_by":"andri"}]}
{"id":"crook-j6g","title":"Create reusable TUI components","description":"Build reusable Bubble Tea components: progress bar, status indicator, confirm prompt, table.\n\nAcceptance Criteria:\n- Progress bar with percentage and visual bar (pkg/tui/components/progress.go)\n- Status indicator with icon and color (pkg/tui/components/status.go)\n- Confirmation prompt for y/n questions (pkg/tui/components/confirm.go)\n- Table display for structured data (pkg/tui/components/table.go)\n- All components implement bubbletea.Model interface\n- Responsive to terminal width\n\nContext:\nPer tasks.md 7.2 and specs/tui-interface/spec.md 'Real-time Progress Tracking'.\n\nDeliverables:\n- pkg/tui/components/*.go\n- Unit tests for component logic\n- Example usage","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:58:14.701127481+11:00","created_by":"andri","updated_at":"2026-01-04T11:32:14.752908227+11:00","closed_at":"2026-01-04T11:32:14.752908227+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-j6g","depends_on_id":"crook-51h","type":"parent-child","created_at":"2026-01-03T15:58:30.120136009+11:00","created_by":"andri"},{"issue_id":"crook-j6g","depends_on_id":"crook-b24","type":"blocks","created_at":"2026-01-03T18:09:35.479869695+11:00","created_by":"andri"}]}
{"id":"crook-j8n","title":"Set up CI/CD pipeline with GitHub Actions","description":"Create GitHub Actions workflows for testing, linting, and releases.\n\nAcceptance Criteria:\n- Run tests on every PR\n- Run linters (golangci-lint, go vet)\n- Build binaries for multiple platforms\n- Automated releases with version tagging\n- Coverage reporting\n\nContext:\nPer tasks.md 10.7.\n\nDeliverables:\n- .github/workflows/test.yml\n- .github/workflows/release.yml\n- golangci-lint configuration","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T16:00:14.360903211+11:00","created_by":"andri","updated_at":"2026-01-03T16:00:14.360903211+11:00","dependencies":[{"issue_id":"crook-j8n","depends_on_id":"crook-5a6","type":"parent-child","created_at":"2026-01-03T16:00:22.871068044+11:00","created_by":"andri"}]}
{"id":"crook-j9y","title":"Test TUI in various terminals","description":"Manual and automated testing across terminal emulators.\n\nAcceptance Criteria:\n- Test in xterm, tmux, screen, iTerm, GNOME Terminal\n- Test color support detection\n- Test resize handling\n- Test with different TERM values\n- Document any terminal-specific issues and workarounds\n\nContext:\nPer tasks.md 9.3 and specs/tui-interface/spec.md 'Terminal Compatibility'.\n\nDeliverables:\n- Terminal compatibility matrix\n- Test script for automated checks\n- Documentation of known issues","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T15:59:37.895487001+11:00","created_by":"andri","updated_at":"2026-01-03T15:59:37.895487001+11:00","dependencies":[{"issue_id":"crook-j9y","depends_on_id":"crook-abg","type":"parent-child","created_at":"2026-01-03T15:59:47.626721782+11:00","created_by":"andri"}]}
{"id":"crook-jeg","title":"Remove osd-maintenance.sh bash script","description":"Remove old bash script after Go version is validated.\n\nAcceptance Criteria:\n- Feature parity confirmed (crook-...)\n- Migration guide completed\n- Remove osd-maintenance.sh\n- Update any references in documentation\n- Git commit with clear message\n\nContext:\nPer tasks.md 11.4 and proposal.md - this is a breaking change.\n\nDependencies:\n- Requires feature parity verified\n- Requires migration guide\n\nDeliverables:\n- Removed bash script\n- Updated documentation","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-03T16:00:52.226615082+11:00","created_by":"andri","updated_at":"2026-01-03T16:00:52.226615082+11:00","dependencies":[{"issue_id":"crook-jeg","depends_on_id":"crook-6mb","type":"parent-child","created_at":"2026-01-03T16:01:01.718652525+11:00","created_by":"andri"}]}
{"id":"crook-k2s","title":"Initialize Go module and directory structure","description":"Initialize Go module with proper naming (github.com/\u003cuser\u003e/crook), create cmd/pkg/internal directory structure following Go best practices.\n\nAcceptance Criteria:\n- go.mod created with module path\n- Directory structure: cmd/crook/, pkg/{maintenance,k8s,state,tui,config}/, internal/logger/\n- .gitignore for Go (binaries, vendor, IDE files)\n- Can run 'go build' successfully (even if minimal)\n\nContext:\nThis is the first step in the Go TUI implementation. Sets up the project foundation per the design in openspec/changes/add-go-tui-interface/design.md architecture section.\n\nDeliverables:\n- go.mod file\n- Complete directory tree\n- .gitignore\n- Minimal main.go that compiles","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:52:35.335569388+11:00","created_by":"andri","updated_at":"2026-01-03T18:29:55.071045899+11:00","closed_at":"2026-01-03T18:29:55.071045899+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-k2s","depends_on_id":"crook-cjz","type":"parent-child","created_at":"2026-01-03T15:52:51.562443881+11:00","created_by":"andri"}]}
{"id":"crook-kis","title":"Implement down phase orchestration","description":"Create pkg/maintenance/down.go with complete down phase workflow (writes JSON state file using the v1 shape with a resources array).","acceptance_criteria":"- ExecuteDownPhase(ctx, config, nodeName) orchestrates full down sequence\n- Steps: pre-flight → cordon → set noout → scale operator → discover → scale deployments → save state\n- Wait for each deployment to scale to 0 (readyReplicas check)\n- Create JSON state file only after all operations succeed\n- State file content follows spec: version/node/timestamp/operatorReplicas/resources (kind=Deployment)\n- Progress callbacks for TUI integration\n- Context cancellation support","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:56:26.903044099+11:00","created_by":"andri","updated_at":"2026-01-04T01:28:08.964655494+11:00","closed_at":"2026-01-04T01:28:08.964666114+11:00","dependencies":[{"issue_id":"crook-kis","depends_on_id":"crook-42s","type":"parent-child","created_at":"2026-01-03T15:56:38.793590573+11:00","created_by":"andri"},{"issue_id":"crook-kis","depends_on_id":"crook-0c6","type":"blocks","created_at":"2026-01-03T18:09:14.809187487+11:00","created_by":"andri"},{"issue_id":"crook-kis","depends_on_id":"crook-npb","type":"blocks","created_at":"2026-01-03T18:09:14.831095642+11:00","created_by":"andri"}]}
{"id":"crook-ku1","title":"Implement K8s client initialization","description":"Create pkg/k8s/client.go with client initialization from kubeconfig and in-cluster config.\n\nAcceptance Criteria:\n- Load kubeconfig from --kubeconfig flag, KUBECONFIG env, or ~/.kube/config\n- Support in-cluster config (ServiceAccount token)\n- Validate connectivity with /version endpoint\n- Return typed clientset\n- Proper error messages for common failures\n- Thread-safe initialization\n\nContext:\nImplements specs/kubernetes-client/spec.md 'Client Initialization' requirement. This is the foundation for all K8s interactions.\n\nImplementation Notes:\n- Use client-go BuildConfigFromFlags() and InClusterConfig()\n- Cache clientset after initialization\n- Add context support for timeout\n\nDependencies:\n- Requires go.mod with client-go dependency\n\nDeliverables:\n- pkg/k8s/client.go with NewClient() function\n- Unit tests with mocked kubeconfig\n- Error handling for missing config","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:53:46.725103878+11:00","created_by":"andri","updated_at":"2026-01-03T19:20:13.747893168+11:00","closed_at":"2026-01-03T19:20:13.747893168+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-ku1","depends_on_id":"crook-09q","type":"parent-child","created_at":"2026-01-03T15:54:01.483213671+11:00","created_by":"andri"}]}
{"id":"crook-l97","title":"Create main app model with routing","description":"Build main Bubble Tea app model that routes to dashboard/down/up models.\n\nAcceptance Criteria:\n- App model manages global state and routing\n- Route to dashboard, down, or up based on command\n- Handle global keyboard shortcuts (Ctrl+C, ?)\n- Terminal size detection and resize handling\n- Graceful shutdown on exit\n- Error display for initialization failures\n\nContext:\nPer tasks.md 7.3. Top-level TUI coordinator.\n\nDeliverables:\n- pkg/tui/models/app.go\n- Init(), Update(), View() methods\n- Model routing logic","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:58:19.655485325+11:00","created_by":"andri","updated_at":"2026-01-04T09:07:22.119358694+11:00","closed_at":"2026-01-04T09:07:22.119358694+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-l97","depends_on_id":"crook-51h","type":"parent-child","created_at":"2026-01-03T15:58:30.19807382+11:00","created_by":"andri"}]}
{"id":"crook-la1","title":"Add context-based cancellation support","description":"Ensure all K8s client operations support Go context for cancellation and timeout.\n\nAcceptance Criteria:\n- All functions accept context.Context as first parameter\n- Operations abort cleanly on context.Canceled\n- Operations abort cleanly on context.DeadlineExceeded\n- Default timeout of 30 seconds for API calls\n- Cleanup resources on cancellation\n- Proper error messages for canceled vs timeout\n\nContext:\nImplements specs/kubernetes-client/spec.md 'Context-based Cancellation' requirement. Critical for responsive Ctrl+C handling in TUI.\n\nImplementation Notes:\n- Wrap all clientset operations with context\n- Use context.WithTimeout() for default timeouts\n- Propagate context to wait operations\n- Test cancellation during long-running operations\n\nTest Cases:\n- Cancel operation with Ctrl+C simulation\n- Operation timeout after 30s\n- Successful completion within timeout\n- Cancellation during wait loop\n\nDeliverables:\n- Context support in all pkg/k8s functions\n- Unit tests for cancellation scenarios\n- Updated godoc with context usage examples","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:53:54.17837663+11:00","created_by":"andri","updated_at":"2026-01-03T19:30:22.291562317+11:00","closed_at":"2026-01-03T19:30:22.291562317+11:00","close_reason":"Context cancellation fully implemented - all operations accept ctx and propagate it correctly","dependencies":[{"issue_id":"crook-la1","depends_on_id":"crook-09q","type":"parent-child","created_at":"2026-01-03T15:54:01.597622741+11:00","created_by":"andri"}]}
{"id":"crook-lgk","title":"Implement node status monitoring","description":"Create pkg/monitoring/node.go for real-time node status monitoring.\n\nAcceptance Criteria:\n- MonitorNodeStatus(ctx, k8sClient, nodeName) returns node status struct\n- Extract: Ready condition, scheduling status, taints, kubelet version, pod count\n- Color-coded status: Ready=green, NotReady=red, Unknown=yellow\n- Refresh every 2 seconds via goroutine\n- Send updates via channel for TUI\n\nContext:\nImplements specs/cluster-monitoring/spec.md 'Node Status Monitoring' requirement.\n\nDependencies:\n- Requires K8s client node operations\n\nDeliverables:\n- pkg/monitoring/node.go\n- Background refresh goroutine\n- Unit tests","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:57:12.855945768+11:00","created_by":"andri","updated_at":"2026-01-04T00:43:53.894116296+11:00","closed_at":"2026-01-04T00:43:53.894120625+11:00","dependencies":[{"issue_id":"crook-lgk","depends_on_id":"crook-4w6","type":"parent-child","created_at":"2026-01-03T15:57:29.986993017+11:00","created_by":"andri"}]}
{"id":"crook-li7","title":"Implement Ceph command execution","description":"Create pkg/k8s/ceph.go with Ceph CLI command execution via rook-ceph-tools pod.\n\nAcceptance Criteria:\n- ExecuteCephCommand(ctx, namespace, command) finds rook-ceph-tools pod and executes command\n- SetNoOut(ctx, namespace) executes 'ceph osd set noout'\n- UnsetNoOut(ctx, namespace) executes 'ceph osd unset noout'\n- GetCephStatus(ctx, namespace) executes 'ceph status --format json' and parses\n- GetOSDTree(ctx, namespace) executes 'ceph osd tree --format json' and parses\n- Return stdout, stderr, and exit code\n- Handle rook-ceph-tools not found error with helpful message\n\nContext:\nImplements specs/kubernetes-client/spec.md 'Ceph Command Execution' requirement. Used for cluster health monitoring and noout flag management.\n\nImplementation Notes:\n- Find rook-ceph-tools deployment, select ready pod\n- Use ExecInPod from pods.go\n- Parse JSON output for status/tree commands\n- Include documentation link in error messages\n\nTest Cases:\n- Execute simple Ceph command\n- Parse ceph status JSON\n- Parse ceph osd tree JSON\n- rook-ceph-tools not found\n- Command failure with non-zero exit\n\nDeliverables:\n- pkg/k8s/ceph.go\n- Unit tests with mocked exec\n- Helper functions for common Ceph operations","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:53:51.456505871+11:00","created_by":"andri","updated_at":"2026-01-03T19:27:35.30190517+11:00","closed_at":"2026-01-03T19:27:35.30190517+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-li7","depends_on_id":"crook-09q","type":"parent-child","created_at":"2026-01-03T15:54:01.560804985+11:00","created_by":"andri"},{"issue_id":"crook-li7","depends_on_id":"crook-ku1","type":"blocks","created_at":"2026-01-03T18:09:42.100762857+11:00","created_by":"andri"},{"issue_id":"crook-li7","depends_on_id":"crook-86k","type":"blocks","created_at":"2026-01-03T18:09:42.125289654+11:00","created_by":"andri"}]}
{"id":"crook-lnc","title":"Add core dependencies to go.mod","description":"Add all required dependencies: Bubble Tea, client-go, Cobra, Viper with specific versions.\n\nAcceptance Criteria:\n- Bubble Tea (github.com/charmbracelet/bubbletea) added\n- Kubernetes client-go (k8s.io/client-go + k8s.io/api + k8s.io/apimachinery) added\n- Cobra (github.com/spf13/cobra) added\n- Viper (github.com/spf13/viper) added\n- go.sum generated with checksums\n- 'go mod tidy' runs cleanly\n- No version conflicts\n\nContext:\nPer proposal.md impact section, these are the core dependencies needed. Using latest stable versions that are compatible.\n\nDeliverables:\n- Updated go.mod with all dependencies\n- go.sum file","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:52:36.676107381+11:00","created_by":"andri","updated_at":"2026-01-03T19:06:41.800502379+11:00","closed_at":"2026-01-03T19:06:41.800502379+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-lnc","depends_on_id":"crook-cjz","type":"parent-child","created_at":"2026-01-03T15:52:51.591636871+11:00","created_by":"andri"}]}
{"id":"crook-mxs","title":"Implement OSD status monitoring","description":"Create OSD monitoring for OSDs on target node.\n\nAcceptance Criteria:\n- MonitorOSDStatus(ctx, k8sClient, namespace, nodeName) returns OSD list\n- Execute 'ceph osd tree --format json' and parse\n- Filter OSDs by node name\n- Extract: OSD ID, status (up/down, in/out), weight, deployment name mapping\n- Detect noout flag\n- Refresh every 5 seconds\n\nContext:\nImplements specs/cluster-monitoring/spec.md 'OSD Status Monitoring' requirement.\n\nDeliverables:\n- OSD monitoring in pkg/monitoring/ceph.go\n- Unit tests","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:57:16.513419051+11:00","created_by":"andri","updated_at":"2026-01-04T00:43:56.403698908+11:00","closed_at":"2026-01-04T00:43:56.403701533+11:00","dependencies":[{"issue_id":"crook-mxs","depends_on_id":"crook-4w6","type":"parent-child","created_at":"2026-01-03T15:57:30.029167729+11:00","created_by":"andri"}]}
{"id":"crook-npb","title":"Implement pre-flight validation checks","description":"Create pkg/maintenance/validator.go with comprehensive pre-flight checks.\n\nAcceptance Criteria:\n- ValidateDownPhase(ctx, k8sClient, nodeName) checks all prerequisites\n- Check cluster connectivity\n- Check node exists\n- Check namespaces exist (operator + cluster)\n- Check rook-ceph-tools deployment exists and ready\n- Check RBAC permissions (best-effort)\n- Return structured validation results with actionable errors\n\nContext:\nImplements specs/node-maintenance/spec.md 'Pre-flight Validation' requirement. Prevents operations in misconfigured environments.\n\nDependencies:\n- Requires K8s client operations (crook-09q children)\n\nTest Cases:\n- All checks pass\n- Node not found\n- Namespace missing\n- rook-ceph-tools not ready\n- Permission denied\n\nDeliverables:\n- pkg/maintenance/validator.go\n- Unit tests\n- Clear error messages with remediation steps","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:56:25.7524636+11:00","created_by":"andri","updated_at":"2026-01-04T01:23:03.041474698+11:00","closed_at":"2026-01-04T01:23:03.041477474+11:00","dependencies":[{"issue_id":"crook-npb","depends_on_id":"crook-42s","type":"parent-child","created_at":"2026-01-03T15:56:38.774489642+11:00","created_by":"andri"}]}
{"id":"crook-nr9","title":"Final Validation \u0026 Release","description":"OpenSpec validation, requirement verification, manual testing, v1.0.0 release","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-03T15:52:06.479973256+11:00","created_by":"andri","updated_at":"2026-01-03T15:52:06.479973256+11:00","dependencies":[{"issue_id":"crook-nr9","depends_on_id":"crook-6mb","type":"blocks","created_at":"2026-01-03T16:01:42.620294325+11:00","created_by":"andri"}]}
{"id":"crook-o0k","title":"End-to-end test: down/up with JSON state file","description":"Run an end-to-end test of the Go workflow where 'crook down' writes a JSON state file and 'crook up' restores from that JSON state file, validating behavior against the OpenSpec requirements.","acceptance_criteria":"- Run 'crook down' and confirm a .json state file is created\n- Verify the JSON file includes required fields (version, node, timestamp, operatorReplicas, resources)\n- Verify JSON is pretty-printed (2-space indent) with trailing newline\n- Run 'crook up' using that state file and verify successful restoration\n- Record any issues and required follow-up","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T16:00:48.657850663+11:00","created_by":"andri","updated_at":"2026-01-03T21:13:06.138322815+11:00","dependencies":[{"issue_id":"crook-o0k","depends_on_id":"crook-6mb","type":"parent-child","created_at":"2026-01-03T16:01:01.655381638+11:00","created_by":"andri"}]}
{"id":"crook-oh6","title":"Implement structured logger package","description":"Create internal/logger package with structured logging supporting multiple levels and outputs.\n\nAcceptance Criteria:\n- Logger supports levels: DEBUG, INFO, WARN, ERROR\n- Can output to stdout, stderr, and file\n- Structured format with timestamp, level, message, fields\n- Configurable log level\n- Thread-safe for concurrent use\n- Simple API: logger.Info(), logger.Error(), etc.\n\nContext:\nReferenced throughout tasks.md (1.5, 8.1, etc). Needed early as other components will use it. Keep simple - use standard library or minimal dependency like slog.\n\nImplementation Notes:\n- Use Go 1.21+ slog package for structured logging\n- Support JSON and text formats\n- File rotation not needed for v1\n\nDeliverables:\n- internal/logger/logger.go\n- Unit tests for logger\n- Example usage in godoc","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:52:37.918867685+11:00","created_by":"andri","updated_at":"2026-01-03T19:10:05.188458323+11:00","closed_at":"2026-01-03T19:10:05.188458323+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-oh6","depends_on_id":"crook-cjz","type":"parent-child","created_at":"2026-01-03T15:52:51.609678059+11:00","created_by":"andri"}]}
{"id":"crook-oro","title":"Create dashboard model for cluster health","description":"Build Bubble Tea model for cluster health dashboard.\n\nAcceptance Criteria:\n- Display node status, Ceph health, OSD status, deployments\n- Background refresh from monitoring channels\n- User can proceed (Enter) or cancel (Esc)\n- Warning indicators for degraded/critical health\n- Refresh timestamp in corner\n- Responsive layout\n\nContext:\nImplements specs/tui-interface/spec.md 'Cluster Health Dashboard'. Per design.md state machine, this is Init state.\n\nDependencies:\n- Requires monitoring components (crook-4w6)\n- Requires TUI components\n\nDeliverables:\n- pkg/tui/models/dashboard.go\n- Integration with monitoring\n- Unit tests","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:58:16.172381915+11:00","created_by":"andri","updated_at":"2026-01-04T13:18:53.235947878+11:00","closed_at":"2026-01-04T13:18:53.235947878+11:00","close_reason":"Implemented in commit 4613c3d - dashboard model with real-time monitoring","dependencies":[{"issue_id":"crook-oro","depends_on_id":"crook-51h","type":"parent-child","created_at":"2026-01-03T15:58:30.139493284+11:00","created_by":"andri"},{"issue_id":"crook-oro","depends_on_id":"crook-j6g","type":"blocks","created_at":"2026-01-03T18:09:21.121025201+11:00","created_by":"andri"},{"issue_id":"crook-oro","depends_on_id":"crook-11d","type":"blocks","created_at":"2026-01-03T18:09:21.14320464+11:00","created_by":"andri"}]}
{"id":"crook-p0b","title":"Implement JSON format writer","description":"Create pkg/state/writer.go with JSON serialization using encoding/json, pretty-printing, and deterministic resource ordering.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:54:51.053702227+11:00","created_by":"andri","updated_at":"2026-01-03T21:46:01.521863467+11:00","closed_at":"2026-01-03T21:46:01.521863467+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-p0b","depends_on_id":"crook-z1v","type":"parent-child","created_at":"2026-01-03T15:55:03.276379124+11:00","created_by":"andri"},{"issue_id":"crook-p0b","depends_on_id":"crook-umx","type":"blocks","created_at":"2026-01-03T18:09:28.697362387+11:00","created_by":"andri"}]}
{"id":"crook-pwi","title":"Verify feature parity with bash script","description":"Comprehensive comparison of Go TUI features vs bash script functionality.\n\nAcceptance Criteria:\n- List all bash script features\n- Verify each feature exists in Go version\n- Document any intentional differences\n- Test side-by-side comparison\n- Sign-off on parity completion\n\nContext:\nPer tasks.md 11.2. Ensures no regression in functionality.\n\nDeliverables:\n- Feature parity checklist\n- Comparison matrix\n- Sign-off document","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T16:00:46.951458264+11:00","created_by":"andri","updated_at":"2026-01-03T16:00:46.951458264+11:00","dependencies":[{"issue_id":"crook-pwi","depends_on_id":"crook-6mb","type":"parent-child","created_at":"2026-01-03T16:01:01.629921839+11:00","created_by":"andri"}]}
{"id":"crook-sai","title":"Implement deployment operations","description":"Create pkg/k8s/deployments.go with scale, status, list, and wait operations for deployments.\n\nAcceptance Criteria:\n- ScaleDeployment(ctx, namespace, name, replicas) updates .spec.replicas\n- GetDeploymentStatus(ctx, namespace, name) returns replicas, ready, available counts\n- ListDeploymentsInNamespace(ctx, namespace) returns all deployments\n- WaitForReadyReplicas(ctx, namespace, name, expected, timeout) polls until ready\n- WaitForReplicas(ctx, namespace, name, expected, timeout) polls until replicas match\n- All operations support context cancellation and timeout\n\nContext:\nImplements specs/kubernetes-client/spec.md 'Deployment Operations' requirement. Core to down/up orchestration in specs/node-maintenance/spec.md.\n\nImplementation Notes:\n- Use clientset.AppsV1().Deployments()\n- Wait functions should poll every 5 seconds (configurable)\n- Use watch API for efficient waiting (optional enhancement)\n- Handle deployment not found gracefully\n\nTest Cases:\n- Scale deployment to 0\n- Scale deployment to 3\n- Wait for replicas to reach target\n- Timeout handling\n- Deployment not found\n\nDeliverables:\n- pkg/k8s/deployments.go\n- Unit tests with fake clientset\n- Integration test (optional, needs cluster)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:53:49.202366469+11:00","created_by":"andri","updated_at":"2026-01-03T19:22:07.574763884+11:00","closed_at":"2026-01-03T19:22:07.574763884+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-sai","depends_on_id":"crook-09q","type":"parent-child","created_at":"2026-01-03T15:54:01.523717938+11:00","created_by":"andri"},{"issue_id":"crook-sai","depends_on_id":"crook-ku1","type":"blocks","created_at":"2026-01-03T18:09:42.053260341+11:00","created_by":"andri"}]}
{"id":"crook-tsj","title":"Implement health dashboard aggregation","description":"Create overall health aggregation logic for dashboard display.\n\nAcceptance Criteria:\n- AggregateHealth(nodeStatus, cephHealth, deploymentStatus) returns overall status\n- Calculate: Healthy (all green), Degraded (warnings), Critical (errors)\n- Evaluation rules from specs/cluster-monitoring/spec.md 'Status Aggregation'\n- Return structured health summary with reasons\n- Support for dashboard display formatting\n\nContext:\nImplements dashboard health aggregation per specs.\n\nDeliverables:\n- pkg/monitoring/aggregation.go\n- Unit tests for all health combinations","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:57:19.342141522+11:00","created_by":"andri","updated_at":"2026-01-04T00:43:58.851568522+11:00","closed_at":"2026-01-04T00:43:58.85157269+11:00","dependencies":[{"issue_id":"crook-tsj","depends_on_id":"crook-4w6","type":"parent-child","created_at":"2026-01-03T15:57:30.066096534+11:00","created_by":"andri"}]}
{"id":"crook-umx","title":"Define state data structure","description":"Create pkg/state/state.go with state data structures using Resources []Resource field and JSON struct tags.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:54:49.904352668+11:00","created_by":"andri","updated_at":"2026-01-03T21:46:01.506827695+11:00","closed_at":"2026-01-03T21:46:01.506827695+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-umx","depends_on_id":"crook-z1v","type":"parent-child","created_at":"2026-01-03T15:55:03.253733409+11:00","created_by":"andri"}]}
{"id":"crook-uu0","title":"Write comprehensive README","description":"Create README.md with installation, quickstart, configuration docs, command reference, troubleshooting.\n\nAcceptance Criteria:\n- Installation instructions (pre-built binaries, build from source)\n- Quick start guide with examples\n- Configuration documentation (all options explained)\n- Command reference (all commands and flags)\n- Troubleshooting guide (common issues and solutions)\n- Architecture overview\n- Links to OpenSpec docs\n\nContext:\nPer tasks.md 10.1.\n\nDeliverables:\n- README.md\n- Clear, well-structured documentation","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T16:00:09.363368976+11:00","created_by":"andri","updated_at":"2026-01-03T16:00:09.363368976+11:00","dependencies":[{"issue_id":"crook-uu0","depends_on_id":"crook-5a6","type":"parent-child","created_at":"2026-01-03T16:00:22.78267836+11:00","created_by":"andri"}]}
{"id":"crook-vsj","title":"Verify requirement-to-code mapping","description":"Trace each OpenSpec requirement to implementation and tests.\n\nAcceptance Criteria:\n- Map each requirement in 6 capability specs to code\n- Verify each scenario has corresponding test\n- Document mapping in traceability matrix\n- Identify any gaps\n- Close gaps if found\n\nContext:\nPer tasks.md 12.2.\n\nDeliverables:\n- Traceability matrix (requirement → code → test)\n- Gap analysis (if any)\n- 100% requirement coverage","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T16:01:28.769001272+11:00","created_by":"andri","updated_at":"2026-01-03T16:01:28.769001272+11:00","dependencies":[{"issue_id":"crook-vsj","depends_on_id":"crook-nr9","type":"parent-child","created_at":"2026-01-03T16:01:42.512811153+11:00","created_by":"andri"}]}
{"id":"crook-vuh","title":"Implement 'crook up' command","description":"Create 'crook up \u003cnode\u003e' command for up phase (reads a JSON state file; default template ends with .json).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:58:59.706932416+11:00","created_by":"andri","updated_at":"2026-01-04T14:20:41.860345635+11:00","closed_at":"2026-01-04T14:20:41.860345635+11:00","close_reason":"Up command already implemented with TUI and non-interactive modes, state file handling, timeout support, skip-missing flag, and progress callbacks. Tests pass.","dependencies":[{"issue_id":"crook-vuh","depends_on_id":"crook-3yn","type":"parent-child","created_at":"2026-01-03T15:59:12.243388243+11:00","created_by":"andri"}]}
{"id":"crook-w38","title":"Add terminal compatibility and responsive rendering","description":"Ensure TUI works across terminals with size detection and responsive layout.\n\nAcceptance Criteria:\n- Detect terminal size and handle resize events\n- Warn if width \u003c80 columns\n- Color support detection (256-color, 16-color, no-color)\n- Fallback to ASCII symbols for no-color terminals\n- Test in xterm, tmux, screen\n- Handle TERM=dumb gracefully\n\nContext:\nImplements specs/tui-interface/spec.md 'Terminal Compatibility' requirement.\n\nImplementation Notes:\n- Bubble Tea handles most terminal quirks\n- Add custom handling for edge cases\n- Test with different TERM values\n\nDeliverables:\n- Terminal detection logic\n- Responsive layout calculations\n- Compatibility tests","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:58:21.971014169+11:00","created_by":"andri","updated_at":"2026-01-04T13:38:40.107621207+11:00","closed_at":"2026-01-04T13:38:40.107621207+11:00","close_reason":"Implemented terminal compatibility:\n- pkg/tui/terminal package with capability detection\n- Detects 256-color, 16-color, and no-color terminals\n- ASCII fallback icons for dumb terminals\n- NO_COLOR environment variable support\n- tmux/screen detection\n- Terminal size warning when \u003c80 columns\n- Lipgloss color profile configuration\n- 97.5% test coverage","dependencies":[{"issue_id":"crook-w38","depends_on_id":"crook-51h","type":"parent-child","created_at":"2026-01-03T15:58:30.237188086+11:00","created_by":"andri"}]}
{"id":"crook-w8k","title":"Write K8s client unit tests","description":"Comprehensive unit test suite for all K8s client operations using fake clientset.\n\nAcceptance Criteria:\n- Test coverage \u003e80% for pkg/k8s\n- Use k8s.io/client-go/kubernetes/fake for testing\n- Test success paths for all operations\n- Test error paths (not found, forbidden, timeout)\n- Test retry logic with injected failures\n- Test context cancellation\n- Mock Ceph command execution\n\nContext:\nPer tasks.md section 2.8. Ensures reliability of K8s client wrapper before building higher-level components.\n\nImplementation Notes:\n- Use table-driven tests for multiple scenarios\n- Create test helpers for common setup\n- Test with fake.NewSimpleClientset()\n- Mock pod exec using custom REST client\n\nTest Files:\n- pkg/k8s/client_test.go\n- pkg/k8s/nodes_test.go\n- pkg/k8s/deployments_test.go\n- pkg/k8s/pods_test.go\n- pkg/k8s/ceph_test.go\n- pkg/k8s/retry_test.go\n\nDeliverables:\n- Complete unit test suite\n- Test coverage report (go test -cover)\n- CI integration (runs on PR)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T15:53:54.363194857+11:00","created_by":"andri","updated_at":"2026-01-03T19:30:21.189017265+11:00","closed_at":"2026-01-03T19:30:21.189017265+11:00","close_reason":"Comprehensive unit tests written for all K8s client operations. Test files created: client_test.go, nodes_test.go, deployments_test.go, pods_test.go, ceph_test.go, retry_test.go. Coverage: 45.6%. All tests passing.","dependencies":[{"issue_id":"crook-w8k","depends_on_id":"crook-09q","type":"parent-child","created_at":"2026-01-03T15:54:01.616687919+11:00","created_by":"andri"}]}
{"id":"crook-wfd","title":"Build pre-built binaries for releases","description":"Set up cross-compilation and binary releases for common platforms.\n\nAcceptance Criteria:\n- Linux amd64 binary\n- Linux arm64 binary\n- macOS amd64 binary (Intel)\n- macOS arm64 binary (Apple Silicon)\n- Automated build via CI\n- Checksums for verification\n- Installation script (optional)\n\nContext:\nPer tasks.md 11.6 and proposal.md migration impact.\n\nDeliverables:\n- Release workflow\n- Binaries for all platforms\n- Checksums","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T16:00:50.843335514+11:00","created_by":"andri","updated_at":"2026-01-03T16:00:50.843335514+11:00","dependencies":[{"issue_id":"crook-wfd","depends_on_id":"crook-6mb","type":"parent-child","created_at":"2026-01-03T16:01:01.696916579+11:00","created_by":"andri"}]}
{"id":"crook-x4f","title":"Update project.md to reflect Go implementation","description":"Update OpenSpec project.md with Go implementation details.\n\nAcceptance Criteria:\n- Update technology stack section\n- Update build/dev instructions\n- Remove bash script references\n- Add Go-specific conventions\n\nContext:\nPer tasks.md 11.7.\n\nDeliverables:\n- Updated openspec/project.md","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-03T16:00:53.516999879+11:00","created_by":"andri","updated_at":"2026-01-03T16:00:53.516999879+11:00","dependencies":[{"issue_id":"crook-x4f","depends_on_id":"crook-6mb","type":"parent-child","created_at":"2026-01-03T16:01:01.739532252+11:00","created_by":"andri"}]}
{"id":"crook-xrf","title":"Write end-to-end integration tests","description":"E2E tests for complete workflows using kind or test cluster.\n\nAcceptance Criteria:\n- Test full down phase workflow\n- Test full up phase workflow\n- Test error recovery scenarios\n- Run against real K8s cluster (kind for CI)\n- Test state file persistence and restoration\n- Test with actual Rook-Ceph if possible (or mocks)\n\nContext:\nPer tasks.md 9.1-9.2. Validates complete system integration.\n\nImplementation Notes:\n- Use kind for throwaway test clusters\n- May need to mock Ceph commands if no real Ceph\n- Run in CI with appropriate setup\n\nDeliverables:\n- test/e2e/ directory\n- E2E test suite\n- CI integration","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T15:59:36.680798051+11:00","created_by":"andri","updated_at":"2026-01-03T15:59:36.680798051+11:00","dependencies":[{"issue_id":"crook-xrf","depends_on_id":"crook-abg","type":"parent-child","created_at":"2026-01-03T15:59:47.600734148+11:00","created_by":"andri"}]}
{"id":"crook-y0t","title":"Implement Viper-based config loading with precedence","description":"Create config loader with layered precedence: defaults → file → env → flags.\n\nAcceptance Criteria:\n- LoadConfig() loads from all sources with correct precedence\n- Search config paths: ./crook.yaml, ~/.config/crook/config.yaml, /etc/crook/config.yaml\n- Support explicit --config flag\n- Environment variables with CROOK_ prefix (nested: CROOK_A_B_C → a.b.c)\n- CLI flag overrides (integrated with Cobra)\n- Merge partial configs with defaults\n\nContext:\nImplements specs/configuration/spec.md 'Configuration Loading' and 'Environment Variable Overrides'. Per design.md decision on Viper + Cobra pattern.\n\nImplementation Notes:\n- Use viper.SetConfigName(), AddConfigPath()\n- Use viper.SetEnvPrefix('CROOK')\n- Use viper.AutomaticEnv() with replacer\n- Bind CLI flags to Viper keys\n\nDeliverables:\n- pkg/config/loader.go\n- Unit tests for precedence\n- Example config file","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T15:55:34.053900704+11:00","created_by":"andri","updated_at":"2026-01-03T23:23:46.962067886+11:00","closed_at":"2026-01-03T23:23:46.962067886+11:00","close_reason":"Closed","dependencies":[{"issue_id":"crook-y0t","depends_on_id":"crook-57u","type":"parent-child","created_at":"2026-01-03T15:55:45.39543822+11:00","created_by":"andri"}]}
{"id":"crook-ydm","title":"Revisit global Kubernetes client singleton and package-level wrappers","description":"Background:\\n- pkg/k8s/GetClient caches a global singleton; the first caller's ClientConfig wins, later callers with different kubeconfig/context are ignored.\\n- The package-level wrappers (k8s.CordonNode, k8s.ListPodsOnNode, etc.) implicitly depend on that singleton, making tests and multi-cluster usage harder.\\n\\nAcceptance criteria:\\n- Decide on a single pattern: (A) pass *Client explicitly everywhere, or (B) keyed cache by ClientConfig (and document behavior), or (C) keep singleton but remove cfg from GetClient to avoid false expectations.\\n- Add tests covering the chosen behavior (especially config mismatch).\\n- Ensure ExecInPod errors cleanly when c.config is nil (instead of panicking) to make partial clients safe in tests.\\n","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-03T19:45:38.776974918+11:00","created_by":"andri","updated_at":"2026-01-03T19:45:38.776974918+11:00"}
{"id":"crook-z1v","title":"State Persistence","description":"JSON state file management with metadata, atomic writes, validation, and resource tracking using Resources array.","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-03T15:51:54.798286113+11:00","created_by":"andri","updated_at":"2026-01-03T23:06:20.835053025+11:00","closed_at":"2026-01-03T23:06:20.835053025+11:00","close_reason":"Closed"}
